function isEmpty(obj){for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0}function ajax_update(url,params,update,swirl,append){$("#taskMGR").taskQuickLoadShow(),"string"==typeof update&&update&&swirl&&!append&&$(update).html('<center><img src="ajax-loading.gif" /></center>');void 0!=params&&isEmpty(params)&&(params={empty1m:"param"}),$.post(url,params,function(data){$("#taskMGR").taskQuickLoadHide();var resp=parse_response(data);0==resp?"string"==typeof update&&update&&!append&&$(update).html(""):"function"==typeof update?(this.resp=resp,update.apply(this,arguments)):update&&!append&&"string"==typeof resp?$(update).html(resp):update&&append&&$(update).append(resp)})}function accordion(){$("#accordion  div.sor").hide(),$("#accordion  div.sor:first").show(),$("#accordion  li a:first").addClass("opened"),$("#accordion li a").click(function(){var checkElement=$(this).next();return checkElement.is("div")&&checkElement.is(":visible")?($("#accordion li a").removeClass("opened"),checkElement.hide(),!1):checkElement.is("div")&&!checkElement.is(":visible")?($("#accordion li a").removeClass("opened"),checkElement.show().prev().addClass("opened"),!1):void 0})}function pops(){ajax_update("index.php",{stack:"pop"},function(){initload=1}),setTimeout(function(){0==initload&&$("#taskMGR").taskMgrProgress(1)},400)}function sorterUpdate(low,high,total,pages){if("undefined"!=typeof low&&$("#sorterlow").html(low),"undefined"!=typeof high&&$("#sorterhigh").html(high),"undefined"!=typeof total&&$("#sorterrecords").html(total),"undefined"!=typeof pages&&$("div.pagination").length){var current=parseInt($(".pagination span.current").length&&$(".pagination span.current").eq(0).html()||1)-1;$("div.pagination").html("").pagination(pages,{current_page:current,initial_page:current})}}function parse_response(dta){var data=$.trim(dta);if(0!=data.indexOf("<!-- {"))return!1;var codes=eval("("+data.substr(data.indexOf("<!-- ")+4,data.indexOf("-->")-4)+")"),i=0;for(i=0;i<codes.ERROR.length;i++)$("#taskMGR").taskMgrAddError(codes.ERROR[i]);for(i=0;i<codes.INFO.length;i++)$("#taskMGR").taskMgrAddInfo(codes.INFO[i]);if(codes.EVAL)for(i=0;i<codes.EVAL.length;i++)eval(codes.EVAL[i]);$("#taskMGR").taskMgrProgress(codes.STACK),codes.STACK>0&&setTimeout("pops()",10),0==codes.STACK&&codes.INFO.length>0&&$(".submiter").length>0&&$("#currentlist").length>0&&$(".pagination span.current").length>0&&ajax_update($("#currentlist").attr("href")+"&page="+(parseInt($(".pagination span.current").eq(0).html())-1),{once:"1"},$("#currentlist").attr("updater"),!1);var retu=data.substr(data.indexOf("-->")+3,data.length);return""==retu&&(retu=!0),retu}function filter(forms){if($("#currentlist").length>0){var tv=$("#content_tb");return tv.length&&tv.addClass("searchon"),$("#updater").addLoader(),ajax_update($("#currentlist").attr("href")+"&"+$(forms).serialize(),{page:parseInt($(".pagination span.current").eq(0).html())-1},"#updater"),$(".filter-actions z, .freseter").css({display:"inline"}),!1}return!0}function appendLoader(loadername){loadelements.loaders[loadelements.loaders.length]=loadername}function bindClientEvents(){var client_id=$("#client_id","#bodycont").val();$(".clDropdown","#bodycont").click(function(){return!1}),$("#clientform").submit(function(){return $("#old_currency_id").val()!=$("#currency_id").val()?($("#bodycont").css("position","relative"),$("#confirm_curr_change").width($("#bodycont").width()).height($("#bodycont").height()).show(),!1):!0}),$("#sendmail").click(function(){return"custom"!=$("#mail_id").val()?($.post("?cmd=clients&action=sendmail",{mail_id:$("#mail_id","#bodycont").val(),id:client_id},parse_response),!1):void(window.location.href="?cmd=sendmessage&type=clients&selected="+$("#client_id").val())}),$("#sendsms").click(function(){return $.post("?cmd=clients&action=sendsms",{sms_id:$("#sms_id","#bodycont").val(),id:client_id},parse_response),!1}),$("#tdetail a","#bodycont").click(function(){return $(".secondtd","#bodycont").toggle(),$(".tdetails","#bodycont").toggle(),$(".a1","#tdetail").toggle(),$(".a2","#tdetail").toggle(),!1}),$(".livemode","#bodycont").hover(function(){$(this).append('<a href="#" onclick="return false;" class="manuedit">'+lang.edit+"</a>")},function(){$(this).find(".manuedit").remove()}).click(function(){$("#tdetail a").click()}),$(".clDropdown","#bodycont").dropdownMenu({},function(action,el,pos){action=action.substr(action.lastIndexOf("/")+1),"OpenTicket"==action?window.location.href="?cmd=tickets&action=new&client_id="+client_id:"CreateInvoice"==action?window.location.href="?cmd=invoices&action=createinvoice&client_id="+client_id:"PlaceOrder"==action?window.location.href="?cmd=orders&action=add&related_client_id="+client_id:"SendNewPass"==action?ajax_update("?cmd=clients&action=show&make=resetpass&id="+client_id,!1):"CloseAccount"==action?($("#bodycont").css("position","relative"),$("#confirm_cacc_close").width($("#bodycont").width()).height($("#bodycont").height()).show()):"DeleteAccount"==action?($("#bodycont").css("position","relative"),$("#confirm_cacc_delete").width($("#bodycont").width()).height($("#bodycont").height()).show()):"EditNotes"==action?AdminNotes.show():"EnableAffiliate"==action?window.location.href="?cmd=affiliates&action=activate&client_id="+client_id:"DeleteContact"==action?confirm(lang.deleteprofileheading)&&(window.location.href="?cmd=clients&make=deleteprofile&client_id="+client_id+"&parent_id="+$("#parent_id").val()):"ConvertToClient"==action&&confirm(lang.convertclientheading)&&(window.location.href="?cmd=clients&action=convertcontact&client_id="+client_id)}),setTimeout(function(){$("#client_id").length>0&&$("#client_stats").length>0&&ajax_update("?cmd=clients&action=loadstatistics&id="+$("#client_id","#bodycont").val(),{},"#client_stats")},30)}function bindServicesEvents(){$(".addcustom").click(function(){return $("#customfield").toggle(),!1}),$(".iseditable","#bodycont").click(function(){var p=$(this).parents(".editor-container").eq(0);return p.find(".editor").show(),p.find(".org-content").hide(),$(this).parents("tbody.sectioncontent").find(".sectionhead .savesection").show(),!1})}function tload2(){var wind=window;return wind.location.hash&&"#"!=wind.location.hash&&(wind.clearInterval(checkUrlInval),wind.location.hash=""),ajax_update($(this).attr("href"),{},"#bodycont"),$(this).attr("rel")&&(wind.location.hash=$(this).attr("rel").replace(/\s/g,""),checkUrlInval=setInterval(function(){wind.location.hash&&"#"!=wind.location.hash||(wind.clearInterval(checkUrlInval),$("#backto").length>0&&ajax_update($("#backto").attr("href"),{},"#bodycont"),wind.location.hash="")},200)),!1}function bindPredefinied(){$("a.file").unbind("click"),setTimeout(function(){$(".treeview").undelegate("a.folder, .hitarea","click").delegate("a.folder, .hitarea","click",function(){var p=$(this).parent(),last=!1;if((p.hasClass("expandable")||p.hasClass("collapsable"))&&(p.toggleClass("expandable").toggleClass("collapsable"),p.children("div.hitarea").toggleClass("collapsable-hitarea").toggleClass("expandable-hitarea"),(p.hasClass("lastExpandable")||p.hasClass("lastCollapsable"))&&(last=!0,p.toggleClass("lastExpandable").toggleClass("lastCollapsable"),p.children("div.hitarea").toggleClass("lastExpandable-hitarea").toggleClass("lastCollapsable-hitarea"))),p.hasClass("collapsable")){if($(this).hasClass("hitarea"))var hrf=$(this).siblings("a").attr("href");else var hrf=$(this).attr("href");ajax_update(hrf,{},function(data){var resp=parse_response(data);$("#"+p.attr("id")).html(resp),last&&p.children("div.hitarea").addClass("lastCollapsable-hitarea")})}else p.find("ul").remove();return!1})},50)}function bindFreseter(){$(".haspicker").datePicker({startDate:startDate}),$("a.freseter","#content_tb").unbind("click"),$("a.freseter","#content_tb").click(function(){$("a.freseter").hide(),$("form.filterform").each(function(){this.reset()});var tv=$("#content_tb");return tv.length&&tv.removeClass("searchon"),$("#currentlist").length?(ajax_update($("#currentlist").attr("href"),{page:parseInt($(".pagination span.current").eq(0).html())-1,resetfilter:"1"},"#updater"),!1):!0})}function lateInvoiceBind(){$(".tdetail a").unbind("click").click(function(){return $(".secondtd").toggle(),$(".tdetails").toggle(),$(".a1").toggle(),$(".a2").toggle(),!1}),$(".livemode").unbind("mouseenter mouseleave").hover(function(){$(this).append('<a href="#" onclick="return false;" class="manuedit">'+lang.edit+"</a>")},function(){$(this).find(".manuedit").remove()}).unbind("click").click(function(){$(".tdetail a").click()})}function invoiceItemsSubmit(){var line=$(this).parent().parent(),invoice_id=$("#invoice_id").val();if($(line).attr("id")){var lineid=$(line).attr("id").replace("line_",""),linetotal=parseFloat($(line).find(".invqty").eq(0).val())*parseFloat(line.find(".invamount").eq(0).val());line.find("#ltotal_"+lineid).html((Math.round(100*linetotal)/100).toFixed(2))}$.post("?cmd=invoices&action=updatetotals&"+$("#itemsform").serialize(),{id:invoice_id},function(data){var resp=parse_response(data);resp&&($("#updatetotals").html(resp),ajax_update("?cmd=invoices&action=getdetailsmenu",{id:invoice_id},"#detcont"))})}function bindInvoiceDetForm(){function prodcanc(){$("#products").hide(),$("#products").html(""),$("#rmliner").show(),$("#addliners").show(),$("#catoptions_container").hide(),$("#addliners2").hide(),$("#catoptions option").each(function(){$(this).removeAttr("selected")}),$("#catoptions option").eq(1).attr("selected","selected")}lateInvoiceBind();var invoice_id=$("#invoice_id").val();$("#paid_invoice_line .savebtn").unbind("click").click(function(){var l=$(this).parent().parent();return l.find("#invoice_number").html(l.find("textarea").val().replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2")).show(),l.removeClass("editable1").find(".editor-line").hide(),$.post("?cmd=invoices&action=changething&make=changenumber",{id:invoice_id,number:l.find("textarea").val()},function(data){parse_response(data)}),!1}),$(".haspicker").datePicker({startDate:startDate}),$("#standardinvoice").length&&($("#standardinvoice").is(":checked")?($(".standardinvoice").show(),$(".recurringinvoice").hide(),$("#is_recurring").val(0)):($(".recurringinvoice").show(),$(".standardinvoice").hide(),$("#is_recurring").val(1))),$(".removeTrans").unbind("click"),$(".removeTrans").click(function(){var el=$(this),answer=confirm("Do you really want to delete this transaction?");return answer&&$.post($(this).attr("href"),{empty1mc:"param"},function(data){var resp=parse_response(data);1==resp&&(el.parent().parent().slideUp("fast",function(){$(this).remove()}),$(".invitem").eq(0).change())}),!1}),$("#catoptions").unbind("change").change(function(){"-1"==$(this).val()?(ajax_update("?cmd=invoices&action=getblank",{},"#products"),$("#products").show(),$("#rmliner").hide()):"-2"==$(this).val()?(ajax_update("?cmd=invoices&action=getaddon",{currency_id:$("#currency_id").val()},"#products"),$("#products").show(),$("#rmliner").hide()):$(this).val()>"0"&&(ajax_update("?cmd=invoices&action=getproduct",{cat_id:$(this).val(),currency_id:$("#currency_id").val()},"#products"),$("#products").show(),$("#rmliner").hide())}),$("#updateclietndetails").unbind("click").click(function(){$("a",".tdetail").eq(0).click(),ajax_update("?cmd=invoices&action=changething&make=updateclientdetails&id="+invoice_id),ajax_update("?cmd=invoices&action=edit&list=all&id="+invoice_id,{},"#bodycont")}),$("#prodcanc").unbind("click"),$(".prodok").unbind("click").click(function(){if($("#nline").length>0&&""!=$("#nline").val()){var taxa=0;$("#nline_tax").is(":checked")&&(taxa=1),$("#main-invoice").addLoader(),$.post("?cmd=invoices&action=addline",{line:$("#nline").val(),tax:taxa,price:$("#nline_price").val(),qty:$("#nline_qty").val(),id:invoice_id},function(data){var resp=parse_response(data);resp&&($("#main-invoice").html(resp),$("#nline").val(""),$("#nline_price").val(""),$("#nline_tax").removeAttr("checked"))})}else $("#product_id").length>0?$.post("?cmd=invoices&action=addline",{product:$("#product_id").val(),id:invoice_id},function(data){var resp=parse_response(data);resp&&($("#main-invoice").html(resp),$("#detailsform").eq(0).submit())}):$("#addon_id").length>0&&($("#main-invoice").addLoader(),$.post("?cmd=invoices&action=addline",{addon:$("#addon_id").val(),id:invoice_id},function(data){var resp=parse_response(data);resp&&($("#addliners").before(resp),$("#detailsform").eq(0).submit())}));$("#prodcanc").click()}),$("#prodcanc").click(function(){prodcanc()}),$("#rmliner").click(function(){prodcanc()})}function bindDomainEvents(){$(".toLoad").click(function(){return $("#dommanager").show(),$("#man_content").html('<center><img src="ajax-loading.gif" /></center>'),$("#man_title").html($(this).attr("value")),$.post("?cmd=domains&action="+$(this).attr("name"),{val:$(this).attr("value"),id:$("#domain_id").val(),name:$("#domain_name").val()},function(data){$("#man_content").scrollToEl("#man_content");var resp=parse_response(data);resp&&""!=resp?$("#man_content").html(resp):$("#man_content").html(" ")}),!1}),$(".livemode").not("tr").hover(function(){$(this).append('<a href="#" onclick="return false;" class="manuedit">'+lang.edit+"</a>")},function(){$(this).find(".manuedit").remove()}).not("tr").click(function(){$(".changeMode").eq(0).is(":checked")?$(".changeMode").removeAttr("checked").eq(0).trigger("change"):$(".changeMode").attr("checked","checked").eq(0).trigger("change")}),$("#bodycont .changeMode").change(function(){var modes=0;$(this).is(":checked")?(modes=1,$.post("?cmd=domains&action=manualmode",{mode:modes,id:$("#domain_id").val()},function(data){var resp=parse_response(data);resp&&($(".changeMode").attr("checked","checked"),$(".manumode").show(),$(".livemode").hide(),$("#domainname").removeAttr("readonly"),$("#epp_code").show())})):$.post("?cmd=domains&action=manualmode",{mode:modes,id:$("#domain_id").val()},function(data){var resp=parse_response(data);resp&&($(".changeMode").removeAttr("checked"),$(".livemode").show(),$(".manumode").hide(),$(".pen").hide(),$(".nep").show(),$("#domainname").attr("readonly","readonly"),$("#epp_code").hide())})}),$(".setStatus","#bodycont").click(function(){return!1}),$(".setStatus","#bodycont").dropdownMenu({},function(action,el,pos){action=action.substr(action.lastIndexOf("/")+1),"AdminNotes"==action?AdminNotes.show():"ChangeOwner"==action&&($("#ChangeOwner").show(),ajax_update("?cmd=domains&action=getowners",{},"#ChangeOwner",!0))}),$("#sendmail").click(function(){return"custom"!=$("#mail_id").val()?($.post("?cmd=domains&action=sendmail",{mail_id:$("#mail_id").val(),id:$("#domain_id").val()},function(data){parse_response(data)}),!1):void(window.location.href="?cmd=sendmessage&type=domains&selected="+$("#domain_id").val())})}function bindAccountEvents(){$(".toLoad").click(function(){return $("#dommanager").show(),$("#man_content").html('<center><img src="ajax-loading.gif" /></center>'),$("#man_title").html($(this).attr("value")),$.post("?cmd=accounts&action="+$(this).attr("name"),{val:$(this).attr("value"),id:$("#account_id").val()},function(data){var resp=parse_response(data);resp&&""!=resp?$("#man_content").html(resp):$("#man_content").html(" ")}),!1}),$(".livemode").not("tr").not("input[type=submit]").hover(function(){$(this).append('<a href="#" onclick="return false;" class="manuedit">'+lang.edit+"</a>")},function(){$(this).find(".manuedit").remove()}).click(function(){$(".changeMode").eq(0).is(":checked")?$("#changeMode").removeAttr("checked").eq(0).trigger("change"):$("#changeMode").attr("checked","checked").eq(0).trigger("change")}),$("#changeMode").change(function(){var modes=0;$(this).is(":checked")?(modes=1,$.post("?cmd=accounts&action=manualmode",{mode:modes,id:$("#account_id").val()},function(data){var resp=parse_response(data);resp&&($("#changeMode").attr("checked","checked"),$(".h_manumode").removeAttr("disabled"),$("#passchange").show(),$(".manumode").show(),$(".livemode").hide())})):$.post("?cmd=accounts&action=manualmode",{mode:modes,id:$("#account_id").val()},function(data){var resp=parse_response(data);resp&&($("#changeMode").removeAttr("checked"),$(".h_manumode").attr("disabled","disabled"),$(".livemode").show(),$(".manumode").hide(),void 0!=$("#product_id option[def]")&&($(':input[id="product_id"]')[0].selectedIndex=$("#product_id option[def]")[0].index),void 0!=$("#server_id option[def]")&&($(':input[id="server_id"]')[0].selectedIndex=$("#server_id option[def]")[0].index))})}),$("#product_id").change(function(){return $.post("?cmd=accounts&action=getservers",{server_id:$("#server_id").val(),product_id:$(this).val(),manumode:$("#server_id").hasClass("manumode")?"1":"0",show:$(".changeMode").eq(0).is(":checked")?"1":"0"},function(data){var resp=parse_response(data);resp&&$("#serversload").html(resp)}),!1}),$("#sendmail").click(function(){return"custom"!=$("#mail_id").val()?($.post("?cmd=accounts&action=sendmail",{mail_id:$("#mail_id").val(),id:$("#account_id").val()},function(data){parse_response(data)}),!1):void(window.location.href="?cmd=sendmessage&type=accounts&selected="+$("#account_id").val())}),$(".setStatus").click(function(){return!1}),$(".setStatus").dropdownMenu({},function(action,el,pos){if(action=action.substr(action.lastIndexOf("/")+1),"AdminNotes"==action)AdminNotes.show();else if("ChangeOwner"==action)$("#ChangeOwner").show(),ajax_update("?cmd=accounts&action=getowners",{},"#ChangeOwner",!0);else if("Delete"==action){if($("#testform input[class=check]:checked").length<1)return alert("Nothing checked"),!1;confirm1()}}),$("#account_id").length>0&&ajax_update("?cmd=accounts&action=getacctaddons",{id:$("#account_id").val()},"#loadaddons")}function bindInvoiceEvents(){var wind=window;""!=wind.location.hash&&wind.location.hash&&"#"==wind.location.hash.substr(0,1)&&$("#invoice_id").length<1&&"#"!=wind.location.hash&&ajax_update("?cmd=invoices&action=edit&list=all&id="+window.location.hash.substr(1),{},"#bodycont");var invoice_id=$("#invoice_id").val();$(".transeditor").change(function(){$.post("?cmd=invoices&action=changething&"+$("#transform").serialize(),{id:invoice_id},function(data){var resp=parse_response(data);1==resp&&$(".invitem").eq(0).change()})}),$("#new_currency_id").change(function(){$("#exrates").find("input").hide(),$("#exrates").find("input").eq($("#new_currency_id")[0].selectedIndex).show()}),$("#calcex").click(function(){$(this).is(":checked")?($("#exrates").show(),$("#exrates").find("input").eq($("#new_currency_id")[0].selectedIndex).show()):$("#exrates").hide()}),$("#addliner").click(function(){return $("#addliners2").show(),$("#catoptions_container").show(),$("#addliners").hide(),!1}),$("a.tload2").click(tload2),setTimeout("lateInvoiceBind()",30),setTimeout("bindInvoiceDetForm()",30),$("#inv_notes").bind("change",function(){$(this).addClass("notes_changed"),$("#notes_submit").show()}),$("#notes_submit input").click(function(){var note=$("#inv_notes").val();return $(this).parent().hide(),$("#inv_notes").removeClass("notes_changed"),$.post("?cmd=invoices&action=changething&make=addnotes",{id:invoice_id,notes:note},function(data){parse_response(data)}),!1}),$(".setStatus").unbind("click").click(function(){return!1}).dropdownMenu({},function(action,el,pos,valx){if(action=action.substr(action.lastIndexOf("/")+1),"Paid"==action||"Unpaid"==action||"Cancelled"==action||"Refunded"==action)$.post("?cmd=invoices&action=changething&make=setstatus",{status:action,id:invoice_id},function(data){var resp=parse_response(data);0!=resp&&null!=resp&&($("#invoice_status").html(valx),$("#invoice_status").attr({"class":action}),$(".addPayment").removeClass("disabled"),$("#hd1_m li").removeClass("disabled"),$("#hd2_m li").removeClass("disabled"),$("li.act_"+action.toLowerCase()).addClass("disabled"))});else if("SplitItems"==action){if($(".invitem_checker").length<2||$(".invitem_checker:checked").length<1)return;var inv=$(".invitem_checker:checked").serialize();$.getJSON("?cmd=invoices&action=split&"+inv,{id:invoice_id},function(data){data.id&&($("#taskMGR").taskMgrAddInfo("Invoice split success"),ajax_update("?cmd=invoices&action=edit&list=all&id="+data.id,{},"#bodycont"),window.location.hash="#"+data.id)})}else if("AddNote"==action)$("#inv_notes").focus();else if("SendReminder2"==action){if($("#testform input[class=check]:checked").length<1)return alert("Nothing checked"),!1;ajax_update("?cmd=invoices&action=bulkreminder&"+$("#testform").serialize(),{stack:"push"})}else"MarkCancelled"==action?$(".markcancelled").eq(0).click():"downloadPDF"==action?wind.location.href="?action=download&invoice="+invoice_id:"EditNumber"==action?$("#paid_invoice_line .editbtn").click():"GenerateFinalId"==action?wind.location.href="?cmd=invoices&action=menubutton&id="+invoice_id+"&make=finalid&security_token="+$("input[name=security_token]").val():"LockInvoice"==action||"UnlockInvoice"==action?wind.location.href="?cmd=invoices&action=menubutton&id="+invoice_id+"&make="+("UnlockInvoice"==action?"unlock":"lock")+"&security_token="+$("input[name=security_token]").val():"EditDetails"==action?$(".tdetail a").click():"SendInvoice"==action?$.post("?cmd=invoices&action=changething&make=sendinvoice",{id:invoice_id},function(data){parse_response(data)}):"IssueRefund"==action?$("#refunds").load("?cmd=invoices&action=refundsmenu&invoice_id="+invoice_id,function(data){$("#refunds").show()}):"ChangeCurrency"==action?$("#chcurr").toggle():"CreateInvoice"==action?wind.location.href="?cmd=invoices&action=createinvoice&client_id="+$("#client_id").val():"SendReminder"==action?$.post("?cmd=invoices&action=changething&make=sendreminder",{id:invoice_id},function(data){parse_response(data)}):"SendMessage"==action&&(wind.location.href="?cmd=sendmessage&type=invoices&selected="+invoice_id)}),$(".addPayment").click(function(){return $(this).hasClass("disabled")||$("#addpay").toggle(),!1}),$(".recstatus").click(function(){if($(this).hasClass("activated"))return!1;var status="Active";return $(this).hasClass("recoff")&&(status="Stopped"),$(".recstatus").removeClass("activated"),$(this).addClass("activated"),$.post("?cmd=invoices&action=changething&make=changerecstatus",{id:invoice_id,recstatus:status},function(data){parse_response(data)}),!1}),$(".sendInvoice").click(function(){return $.post("?cmd=invoices&action=changething&make=sendinvoice",{id:invoice_id},function(data){parse_response(data)}),!1}),$(".deleteInvoice").click(function(){var answer=confirm("Do you really want to delete this invoice?");return answer&&($(this).attr("href")?$.post($(this).attr("href"),{empty1mc:"param"},function(data){parse_response(data);$("#currentpage").eq(0).change()}):$.post("?cmd=invoices&action=menubutton&make=deleteinvoice",{id:invoice_id},function(data){var resp=parse_response(data);1==resp&&(wind.location.href="?cmd=clients&action=show&id="+$("#client_id").val()+"&picked_tab=invoices")})),!1}),$(".invoiceUnlock").click(function(){var that=this;return $.post($(this).attr("href"),{empty1mc:"param"},function(data){parse_response(data);$("a[href=UnlockInvoice]").attr("href","LockInvoice").text("Lock invoice"),$(that).hide()}),!1})}function bindNewOrderEvents(){$(".inv_gen_check").click(function(){$(this).is(":checked")?$("#invsend").removeAttr("disabled"):$("#invsend").removeAttr("checked").attr("disabled","disabled")}),$(".get_prod_btn").change(function(){var elem=$("#product_id");if("new"==$(elem).val())window.location="?cmd=services&action=addproduct",$(elem).val($("select[name='"+$(elem).attr("name")+"'] option:first").val());else{var add="";if($("#client_id").length>0){if("new"==$("#client_id").val())return void(window.location="?cmd=newclient");add="&client_id="+$("#client_id").val()}$("#prod_loader").show(),ajax_update("?cmd=orders&action=get_product"+add,{product_id:$("#product_id").val()},"#product_details")}}),$(".new_gat_btn").change(function(){"new"==$(this).val()&&(window.location="?cmd=managemodules&action=payment",$(this).val($("select[name='"+$(this).attr("name")+"'] option:first").val()))}),$(".setStatus").dropdownMenu({},function(action,el,pos,values){switch(action=action.substr(action.lastIndexOf("/")+1)){case"add_discount":alert("discount"),$(".dis_menu_el").addClass("hidden").hide(),$(".aff_menu_el").hasClass("hidden")&&$(".setStatus").hide();break;case"assign_aff":alert("affiliate"),$(".aff_menu_el").addClass("hidden").hide(),$(".dis_menu_el").hasClass("hidden")&&$(".setStatus").hide()}}),$("#extend_notes").click(function(){$(this).hide(),$('textarea[name="order_notes"]').show()}),$("#add_dom_btn").click(function(){alert("add another domain")}),bindCheckAvailOrd()}function bindCheckAvailOrd(){$(".check_avail").click(function(){$(".avail_result").html('<img src="ajax-loading2.gif" />'),ajax_update("?cmd=orders&action=whois",{domain:$("#domain_sld").val()+$("#domain_tld").val(),type:$("input[name='domain_action']:checked").val()},".avail_result")})}function lateEstimatesBind(){$(".tdetail a").unbind("click").click(function(){return $(".secondtd").toggle(),$(".tdetails").toggle(),$(".a1").toggle(),$(".a2").toggle(),!1}),$(".livemode").unbind("mouseenter mouseleave").hover(function(){$(this).append('<a href="#" onclick="return false;" class="manuedit">'+lang.edit+"</a>")},function(){$(this).find(".manuedit").remove()}).unbind("click").click(function(){$(".tdetail a").click()})}function estimatesItemsSubmit(){var line=$(this).parent().parent(),lineid=$(line).attr("id").replace("line_",""),estimate_id=$("#estimate_id").val();line.find("#ltotal_"+lineid).html((parseFloat($(line).find(".invqty").eq(0).val())*parseFloat(line.find(".invamount").eq(0).val())).toFixed(2)),$.post("?cmd=estimates&action=updatetotals&"+$("#itemsform").serialize(),{id:estimate_id},function(data){var resp=parse_response(data);resp&&($("#updatetotals").html(resp),ajax_update("?cmd=estimates&action=getdetailsmenu",{id:estimate_id},"#detcont"))})}function bindEstimatesDetForm(){function prodcanc(){$("#products").hide(),$("#products").html(""),$("#rmliner").show(),$("#addliners").show(),$("#catoptions_container").hide(),$("#addliners2").hide(),$("#catoptions option").each(function(){$(this).removeAttr("selected")}),$("#catoptions option").eq(1).attr("selected","selected")}lateEstimatesBind();var estimate_id=$("#estimate_id").val();$(".haspicker").datePicker({startDate:startDate}),$("#catoptions").unbind("change").change(function(){"-1"==$(this).val()?(ajax_update("?cmd=estimates&action=getblank",{},"#products"),$("#products").show(),$("#rmliner").hide()):"-2"==$(this).val()?(ajax_update("?cmd=estimates&action=getaddon",{currency_id:$("#currency_id").val()},"#products"),$("#products").show(),$("#rmliner").hide()):$(this).val()>"0"&&(ajax_update("?cmd=estimates&action=getproduct",{cat_id:$(this).val(),currency_id:$("#currency_id").val()},"#products"),$("#products").show(),$("#rmliner").hide())}),$("#prodcanc").unbind("click"),$(".prodok").unbind("click").click(function(){if($("#nline").length>0&&""!=$("#nline").val()){var taxa=0;$("#nline_tax").is(":checked")&&(taxa=1),$("#main-invoice").addLoader(),$.post("?cmd=estimates&action=addline",{line:$("#nline").val(),tax:taxa,price:$("#nline_price").val(),qty:$("#nline_qty").val(),id:estimate_id},function(data){var resp=parse_response(data);resp&&($("#addliners").before(resp),$("#nline").val(""),$("#nline_price").val(""),$("#nline_tax").removeAttr("checked"),$("#detailsform").eq(0).submit())})}else $("#product_id").length>0?$.post("?cmd=estimates&action=addline",{product:$("#product_id").val(),id:estimate_id},function(data){var resp=parse_response(data);resp&&($("#addliners").before(resp),$("#detailsform").eq(0).submit())}):$("#addon_id").length>0&&($("#main-invoice").addLoader(),$.post("?cmd=estimates&action=addline",{addon:$("#addon_id").val(),id:estimate_id},function(data){var resp=parse_response(data);resp&&($("#addliners").before(resp),$("#detailsform").eq(0).submit())}));$("#prodcanc").click()}),$("#prodcanc").click(function(){prodcanc()}),$("#rmliner").click(function(){prodcanc()})}function bindEstimatesEvents(){var estimate_id=$("#estimate_id").val();$("#estsubject").focus(function(){$(this).addClass("sub_hover")}).blur(function(){$(this).removeClass("sub_hover")}).change(function(){var note=$(this).val();$.post("?cmd=estimates&action=changething&make=addsubject",{id:estimate_id,subject:note},function(data){parse_response(data)})}),$("#changeowner").click(function(){return $("#curr_det").hide(),$("#client_container").show(),ajax_update("?cmd=estimates&action=changeowner&client_id="+$("#client_id").val()+"&estimate_id="+estimate_id,!1,"#client_container"),!1}),$("#new_estimate_button").click(function(){$("#new_estimate").hasClass("shown")?$("#new_estimate").hide().removeClass("shown"):$("#new_estimate").hasClass("content_loaded")?$("#new_estimate").show().addClass("shown"):($("#new_estimate").show().addClass("shown"),ajax_update("?cmd=estimates&action=getclients",{},"#new_estimate",!0),$("#new_estimate").addClass("content_loaded"))}),$("#est_notes").bind("textchange",function(){$(this).addClass("notes_changed"),$("#notes_submit").show()}),$("#est_admin_notes").bind("textchange",function(){$(this).addClass("notes_changed"),$("#admin_notes_submit").show()}),$("#notes_submit input").click(function(){var note=$("#est_notes").val();return $(this).parent().hide(),$("#est_notes").removeClass("notes_changed"),$.post("?cmd=estimates&action=changething&make=addnotes",{id:estimate_id,notes:note},function(data){parse_response(data)}),!1}),$("#admin_notes_submit input").click(function(){var note=$("#est_admin_notes").val();return $(this).parent().hide(),$("#est_admin_notes").removeClass("notes_changed"),$.post("?cmd=estimates&action=changething&make=addprivatenotes",{id:estimate_id,notes_private:note},function(data){parse_response(data)}),!1}),$(".sendEstimate").click(function(){$.post("?cmd=estimates&action=changething&make=sendestimate",{id:estimate_id},function(data){parse_response(data),$("#hd1_m li").removeClass("disabled"),$("li.act_sent").addClass("disabled"),$("#estimate_status").html($("li.act_sent a").html()),$("#estimate_status").attr({"class":"Sent"})})}),$(".setStatus").dropdownMenu({},function(action,el,pos,values){action=action.substr(action.lastIndexOf("/")+1),"Draft"==action||"Sent"==action||"Accepted"==action||"Invoiced"==action||"Dead"==action?$.post("?cmd=estimates&action=changething&make=setstatus",{status:action,id:estimate_id},function(data){var resp=parse_response(data);0!=resp&&null!=resp&&("Invoiced"==action?($("button.invoiced_").attr("disabled","disabled"),$(".invoiced_").addClass("disabled")):($("button.invoiced_").removeAttr("disabled"),$(".invoiced_").removeClass("disabled")),$("#estimate_status").html(values),$("#estimate_status").attr({"class":action}),$("#hd1_m li").removeClass("disabled"),$("li.act_"+action.toLowerCase()).addClass("disabled"),"Dead"==action||"Draft"==action?$("#clientlink").hide():$("#clientlink").ShowNicely())}):"AddNote"==action?$("#est_notes").focus():"AddPrivateNote"==action?$("#est_admin_notes").focus():"EditDetails"==action?$(".tdetail a").click():"CreateInvoice"==action?$.post("?cmd=estimates&action=createinvoice",{id:estimate_id},function(data){parse_response(data)}):"downloadPDF"==action?window.location.href="?action=download&estimate="+estimate_id:"ChangeCurrency"==action?$("#chcurr").toggle():"CreateInvoice"==action&&(window.location.href="?cmd=estimates&action=edit&make=createinvoice&id="+estimate_id)}),$("#new_currency_id").change(function(){$("#exrates").find("input").hide(),$("#exrates").find("input").eq($("#new_currency_id")[0].selectedIndex).show()}),$("#calcex").click(function(){$(this).is(":checked")?($("#exrates").show(),$("#exrates").find("input").eq($("#new_currency_id")[0].selectedIndex).show()):$("#exrates").hide()}),$("#addliner").click(function(){return $("#addliners2").show(),$("#catoptions_container").show(),$("#addliners").hide(),!1}),$(".deleteEstimate").click(function(){var answer=confirm("Do you really want to delete this estimate?");return answer&&($(this).attr("href")?$.post($(this).attr("href"),{
empty1mc:"param"},function(data){parse_response(data);$("#currentpage").eq(0).change()}):$.post("?cmd=estimates&action=menubutton&make=deleteestimate",{id:estimate_id},function(data){var resp=parse_response(data);1==resp&&(window.location.href="?cmd=clients&action=show&id="+$("#client_id").val()+"&picked_tab=estimates")})),!1}),$(".tdetail a").unbind("click").click(function(){return $(".secondtd").toggle(),$(".tdetails").toggle(),$(".a1").toggle(),$(".a2").toggle(),!1}),$(".livemode").unbind("mouseenter mouseleave").hover(function(){$(this).append('<a href="#" onclick="return false;" class="manuedit">'+lang.edit+"</a>")},function(){$(this).find(".manuedit").remove()}).unbind("click").click(function(){$(".tdetail a").click()}),bindEstimatesDetForm()}function bindTicketEvents(){function bindTicketNoteRemove(){return $(".ticketnotesremove").length<2&&($("#ticketnotebox").slideUp(),$(".badd").show()),$(this).parents("tr").eq(0).hide(),ajax_update("?cmd=tickets",{make:"removenote",action:"menubutton",id:ticket_num,noteid:this.hash.slice(1)},function(data){$("#ticketnotes").html(data),$(".ticketnotesremove").bind("click",bindTicketNoteRemove)}),!1}var ticket_num=$("#ticket_number").val(),wind=window,doc=document,backref=$("#backredirect").val();ticket.initPoll(),$("#ticketsubmitter").click(function(){ticket.autopoll=!1}),$("#showlatestreply").click(function(){var ttime="";return $(this).attr("rel")?(ttime=$(this).attr("rel"),$(this).removeAttr("rel")):ttime=$("#recentreplies input.viewtime:last").val(),ajax_update("?cmd=tickets",{action:"menubutton",make:"getrecent",viewtime:ttime,id:$("#ticket_number").val()},"#recentreplies",!1,!0),$("#justadded").hide(),!1}),""!=wind.location.hash&&wind.location.hash&&"#"==wind.location.hash.substr(0,1)&&$("#ticket_id").length<1&&"#"!=wind.location.hash&&ajax_update("?cmd=tickets&action=view&list=all&num="+window.location.hash.substr(1),{brc:backref},"#bodycont"),$(".scroller").click(function(){var $target=$("[name="+$(this).attr("href").substr(1)+"]");if($target.length){var targetOffset=$target.offset().top;return $("html,body").animate({scrollTop:targetOffset-100},500,"linear",function(){$("#replyarea").focus()}),!1}}),$("#replyarea").keydown(function(){$("#draftinfo .controls").is(":visible")||""==$("#replyarea").val()||($("#draftinfo .controls").show(),$("#draftinfo .draftdate").show())}),$("#ticketnotessave").click(function(){var data=$("input,textarea",".admin-note-new").serializeObject();return data.make="savenotes",data.action="menubutton",data.id=ticket_num,ajax_update("?cmd=tickets",data,function(data){$("#ticketnotes").html(data),$(".ticketnotesremove").bind("click",bindTicketNoteRemove)}),$("#ticketnotesarea").val(""),!1}),$("#ticketnotesfile").click(function(){var resultlist={},place=$('<div class="result"><input type="file" data-upload="?cmd=downloads&action=upload" /></div>').appendTo(".admin-note-new .admin-note-attach").bind("fileuploadsend",function(e,data){place.children().hide();for(var i in data.files)resultlist[i]=$('<div class="upload-result"><a class="attachment" >'+data.files[i].name+'</a> <span class="ui-autocomplete-loading" style="padding: 10px;"></span></div>').appendTo(place)}).bind("fileuploadalways",function(e,data){place.children("input").remove();for(var i in data.result)if(resultlist[i]){var r=resultlist[i];r.children("span").remove(),data.result[i].error?r.append("<span>"+data.result[i].error+"</span>"):(r.append('<input name="attachments[]" value="'+data.result[i].hash+'" type="hidden"/>'),$('<a href="#" class="editbtn"></a>').append("<small>&#91;Remove&#93;</small>").appendTo(r).click(function(){return $.post(data.result[i].delete_url),r.remove(),!1}))}});return fileupload_init(),!1}),ticket_num&&ajax_update("?cmd=tickets",{action:"menubutton",make:"loadnotes",id:ticket_num},function(data){$("#ticketnotes").html(data),$(".ticketnotesremove").bind("click",bindTicketNoteRemove)}),$(".attach").click(function(){return $("#attachments").show(),$("#attachments").append('<br/><input type="file" size="50" name="attachments[]" class="attachment"/>'),!1}),$(".deleteTicket").click(function(){var answer=confirm("Do you really want to delete this ticket?");return answer&&$.post("?cmd=tickets&action=menubutton&make=deleteticket",{tnum:ticket_num},function(data){var resp=parse_response(data);1==resp&&$(".tload.selected").trigger("click")}),!1}),$(".deletereply").click(function(){var answer=confirm("Do you really want to delete this reply?"),rin=$(this).attr("href").substr($(this).attr("href").lastIndexOf("/")+1);return answer&&$.post("?cmd=tickets&action=menubutton&make=deletereply",{rid:rin,tnum:ticket_num},function(data){var resp=parse_response(data);1==resp&&$("#reply_"+rin).slideUp("slow",function(){$(this).remove()})}),!1}),$("#ticket_editform").submit(function(event){event.preventDefault();var form=this;return $.post("?cmd=tickets&"+$(this).serialize(),{},function(data){var resp=parse_response(data);1==resp&&($("#ticket_editdetails").hide(),ajax_update($(form).attr("action"),{brc:backref},"#bodycont"))}),!1}),$("a.editTicket").click(function(event){event.preventDefault();var op=[400,260];if($(".tdetails").data("cls")&&(op=[230,""]),$(".tdetails tr").show(),$(".tdetails").animate({width:op[0]},{queue:!0}).data("cls",400==op[0]).find("input[name], select[name]").each(function(){var self=$(this);self.unbind(".edit").bind("change.edit",function(){self.is("select")?self.prev().text(self.children('[value="'+self.val()+'"]').text()):self.prev().text(self.val())}),self.parents("td").eq(0).children(":first").toggle().siblings().toggle();var val=$(this).val();!self.parents(".sh_row").length||val.length&&(!self.is("select")||"0"!=val&&0!=val)||self.parents(".sh_row").hide()}),400==op[0])$(".tdetails tr").show();else{$(".tdetails tr.sh_row.force").hide();var data=$("input[name], select[name], textarea[name], button[name]",".tdetails").serializeObject();data.action="menubutton",data.make="edit_ticket",data.ticket_number=ticket_num,$.post("?cmd=tickets",data,function(data){$.post("?cmd=tickets&action=view&list=all&num="+ticket_num,{brc:backref},function(data){var reply=$("#replyarea").val();data=parse_response(data),data&&$("#bodycont").html($(data).find("#replyarea").val(reply).end())})})}$(".tdetails table tr:first td:last").animate({width:op[1]},{queue:!0})}),$("a.editor").click(function(event){event.preventDefault();var id=$(this).attr("href");(void 0==typeof id||"#"==id)&&(id="");var elem=$(this).parents(".ticketmsg");return $.post("?cmd=tickets&action=menubutton&make=getreply",{rid:""==id?$("#ticket_id").val():id,rtype:""==id?"ticket":"reply"},function(data){if(void 0!=typeof data.reply)var h=$("#msgbody"+id,elem).height();$("#editbody"+id,elem).show().children("textarea").height(h).val(data.reply).elastic(),$("#msgbody"+id,elem).hide(),$(".editbytext",elem).hide()}),!1}),$("a.editorsubmit").click(function(event){event.preventDefault();var id=$(this).attr("href");(void 0==typeof id||"#"==id)&&(id="");var elem=$(this).parents(".ticketmsg");return $.post("?cmd=tickets&action=menubutton&make=editreply",{rid:""==id?$("#ticket_id").val():id,rtype:""==id?"ticket":"reply",body:$("#editbody"+id,elem).children("textarea").val()},function(data){var resp=parse_response(data);$("#msgbody"+id,elem).replaceWith(resp).show();$("#editbody"+id,elem).hide()}),!1}),$(".quoter").click(function(){var type="reply";"reply"!=$(this).attr("type")&&(type="ticket");var ribd=$(this).attr("href").substr($(this).attr("href").lastIndexOf("/")+1);return $.post("?cmd=tickets&action=menubutton&make=quote",{rid:ribd,rtype:type},function(data){var resp=parse_response(data);if("string"==typeof resp){var reply=$("#replyarea").val();$("#replyarea").val(reply+"\r\n"+resp),$(".scroller").trigger("click")}}),!1}),$(".tdetail a").click(function(){return $(".tdetails").toggle(),$(".a1").toggle(),$(".a2").toggle(),!1}),$(".ticketmsg").mouseup(function(){var sel=doc.selection?doc.selection.createRange().text:doc.getSelection();""!=sel?$(this).find(".quoter2").show():$(this).find(".quoter2").hide()}),$(".quoter2").click(function(){var sel=doc.selection?doc.selection.createRange().text:doc.getSelection().toString(),reply=$("#replyarea").val();return $("#replyarea").val(reply+"\r\n>"+sel.replace(/\n/g,"\n>")+"\r\n"),$(".scroller").trigger("click"),!1}),$(".setStatus").dropdownMenu({},function(action,el,pos,valx){if(action=action.substr(action.lastIndexOf("/")+1),-1!=action.lastIndexOf("status|"))action=action.substr(action.lastIndexOf("|")+1),$.post("?cmd=tickets&action=menubutton&make=setstatus",{status:action,id:ticket_num},function(data){var resp=parse_response(data);0!=resp&&null!=resp&&($("#ticket_status").html(valx),$("#ticket_status").attr({"class":action}),$("#hd1_m li").removeClass("disabled"),$("li.act_"+action.toLowerCase()).addClass("disabled"),"Closed"==action?($("#replytable").hide(),$("#backto").click()):$("#replytable").show())});else if("Low"==action||"Medium"==action||"High"==action)$.post("?cmd=tickets&action=menubutton&make=setpriority",{priority:action,id:ticket_num},function(data){var resp=parse_response(data);0!=resp&&null!=resp&&($("#hd4_m li").removeClass("disabled"),$("#ticket_status").parent().attr("class","").addClass("prior_"+action),$("li.opt_"+action.toLowerCase()).addClass("disabled"))});else if("Unread"==action)ajax_update("?cmd=tickets&action=menubutton&make=markunread",{id:ticket_num});else if("ShowLog"==action)ajax_update("?cmd=tickets&action=menubutton&make=showlog",{id:$("#ticket_id").val()},"#ticket_log"),$("#ticket_log").show(),$("#ticket_editdetails").hide();else if("blockBody"==action){var sel=doc.selection?doc.selection.createRange().text:doc.getSelection().toString();ajax_update("?cmd=tickets&action=menubutton&make=addban",{tnum:ticket_num,type:"body",text:sel})}else"blockEmail"==action?ajax_update("?cmd=tickets&action=menubutton&make=addban",{tnum:ticket_num,type:"email"}):"blockSubject"==action?ajax_update("?cmd=tickets&action=menubutton&make=addban",{tnum:ticket_num,type:"subject"}):"share:"==action.substr(0,6)?$.post("?cmd=tickets&action=menubutton&make=share",{tnum:ticket_num,uuid:action.substr(6)},function(data){return parse_response(data),ajax_update("?cmd=tickets&action=view&list=all&num="+ticket_num,{brc:backref},"#bodycont"),!1}):"unshare"==action?$.post("?cmd=tickets&action=menubutton&make=unshare",{tnum:ticket_num},function(data){ajax_update("?cmd=tickets&action=view&list=all&num="+ticket_num,{brc:backref},"#bodycont")}):("assign:"==action.substr(0,7)||"subscr:"==action.substr(0,7))&&$.post("?cmd=tickets&action=menubutton&make=assign",{tnum:ticket_num,id:action.substr(7)},function(data){return parse_response(data),ajax_update("?cmd=tickets&action=view&list=all&num="+ticket_num,{brc:backref},function(data){var forms=$("textarea, select, input[type!=hidden]","#replytable form").serializeObject();$("#bodycont").html(parse_response(data)),$.each(forms,function(key){var f=$("[name="+key+"]","#replytable form");f.is("[type=checkbox]")?f.prop("checked","on"==this.toString()):f.val(this.toString())})}),!1})}),$("#bodycont").off("click","a.tload2").on("click","a.tload2",tload2),$(doc).mouseup(function(){var sel=doc.selection?doc.selection.createRange().text:doc.getSelection();""!=sel?$(".highlighter").removeClass("disabled"):($(".highlighter").addClass("disabled"),$(".quoter2").hide())}),$("#client_picker").change(function(){$(this).removeClass("err"),$(this).val()>=0?($("#emailrow").hide(),$("#emailrow2").hide()):$(this).val()<0&&($("#emailrow").show(),$("#emailrow2").show())}),$("#newticketform").submit(function(){return"0"==$("#client_picker").val()?($("#client_picker").addClass("err"),!1):!0});var x=$(".ticketmsg:gt(0)").not(":last");if(x.length>3){var d=$('<div class="ticketmsg tmsgwarn"><h2>Click here to show ('+x.length+") other messages</h2></div>").click(function(){$(".ticketmsg:hidden").show(),$(this).remove()});x.hide().eq(0).before(d)}ticket_num==parseInt(ticket_num)&&$(document).trigger("HostBill.ticketload")}function checkEl(){var p=$(this).parent().parent();$(this).is(":checked")?p.addClass("checkedRow"):p.removeClass("checkedRow")}function bindEvents(repeat){"undefined"!=typeof repeat||$(document).pjax("a[data-pjax]","#bodycont",{timeout:800}).on("pjax:send",function(){$("#taskMGR").taskQuickLoadShow()}).on("pjax:complete",function(){$("#taskMGR").taskQuickLoadHide(),bindEvents(!0)}),$(".leftNav","#body-content").on("click","a[data-pjax].tstyled",function(){$(".leftNav a","#body-content").removeClass("selected"),$(this).addClass("selected")}),bindFreseter(),$("#updater").on("click",".check",checkEl),$("a.vtip_description").vTip(),$(".hpLinks").dropdownMenu({movement:5},function(action){window.location=action}),$(".linkDirectly").click(function(){return window.location=$(this).attr("href"),!1}),$(".havecontrols").hover(function(){$(this).find(".controls").show()},function(){$(this).find(".controls").hide()}),$("a.sortorder").click(function(){return $("#updater").addLoader(),$("a.sortorder").removeClass("asc"),$("a.sortorder").removeClass("desc"),$("#checkall").attr("checked",!1),$("#currentlist").attr("href",$(this).attr("href")),"|ASC"==$(this).attr("href").substring($(this).attr("href").lastIndexOf("|"))?($(this).addClass("asc"),$(this).attr("href",$(this).attr("href").substring(0,$(this).attr("href").lastIndexOf("|"))+"|DESC")):($(this).addClass("desc"),$(this).attr("href",$(this).attr("href").substring(0,$(this).attr("href").lastIndexOf("|"))+"|ASC")),$.post($("#currentlist").attr("href"),{page:parseInt($(".pagination span.current").eq(0).html())-1},function(data){var resp=parse_response(data);resp&&($("#updater").html(resp),$(".check").unbind("click").click(checkEl))}),!1}),$("#checkall").click(function(){$(this).is(":checked")?$(".check").prop("checked",!0).parent().parent().addClass("checkedRow"):$(".check").prop("checked",!1).parent().parent().removeClass("checkedRow")}),$("div.pagination").pagination($("#totalpages").val()),$(".confirm_it").click(function(){return confirm("Are you sure you want to perform this action?")?void 0:!1}),$(".submiter").click(function(){if($(this).hasClass("confirm")&&!confirm("Are you sure you want to perform this action?"))return!1;$(this).hasClass("formsubmit")||$("#updater").addLoader(),$("#checkall").removeAttr("checked").prop("checked",!1);var pushs="";"push"==$(this).attr("queue")&&(pushs="push");var page="";return $(".pagination span.current").length>0&&(page="&page="+(parseInt($(".pagination span.current").eq(0).html())-1)),$(this).hasClass("formsubmit")?(window.location=$("#currentlist").attr("href")+page+"&"+$("#testform").serialize()+"&"+$(this).attr("name"),!1):($.post($("#currentlist").attr("href")+page+"&"+$("#testform").serialize()+"&"+$(this).attr("name"),{stack:pushs},function(data){var resp=parse_response(data);resp&&$("#updater").html(resp)}),!1)}),$("a.nav_el").each(function(n){$(this).click(function(){if($(this).hasClass("direct"))return!0;if($(this).hasClass("nav_sel"))return $(this).removeClass("nav_sel").removeClass("minim"),$("a.nav_el").eq(0).addClass("nav_sel"),$("div.slide").eq(n).hide(),$("div.slide").eq(0).show(),!1;$("#client_tab").find("div.slide").hide();var sht=$("#client_tab").find("div.slide").eq(n);return"Loading"!=$(sht).html()?$(sht).show():(ajax_update($(this).attr("href"),{},"div.slide:eq("+n+")"),$(sht).show()),$("a.nav_el").removeClass("nav_sel").removeClass("minim"),$(this).addClass("nav_sel"),n>0&&$(this).addClass("minim"),!1})}),$("[load]").each(function(i){var el=$(this);if(el.data("loaded"))return!1;if("clients"==el.attr("load"))return Chosen.find(),!1;if(el.is("select"))var child=$('<option class="search_loading" style="padding:0 0 0 20px"> Loading</option>').appendTo(this);$.get(el.attr("load"),function(data){el.data("loaded",!0).append(data),void 0!==child&&child.remove()})})}function bindQConfigEvents(){$("#change_pass").click(function(){var password1=$(this).parents("form").find("input[name='password1']").val(),password2=$(this).parents("form").find("input[name='password2']").val();$("#qc_update").addLoader(),ajax_update("?action=saveqc&make=changepass",{password1:password1,password2:password2,qc_page:"Admin_Pass"},"#qc_update")}),$(".activate_item").click(function(){var type=$(this).parent().find("input[name='type']").val();if("Payment"==type||"Hosting"==type||"Domain"==type){$("#qc_update").addLoader();var filename=$(this).parent().find("select[name='modulename']").val();ajax_update("?action=saveqc&make=activate",{filename:filename,type:type,qc_page:type},"#qc_update")}else if("Servers"==type){$("#qc_update").addLoader();var servername=$(this).parent().find("input[name='name']").val();ajax_update("?action=saveqc&make=addserver",{name:servername,qc_page:"Servers"},"#qc_update")}}),$(".getconfig").click(function(){var id=$(this).parents("form").find("input[name='id']").val(),type=$(this).parents("form").find("input[name='type']").val();if("Payment"==type)var name=".payconfig_"+id;else if("Domain"==type)name=".domconfig_"+id;else{if("Servers"!=type)return!1;name=".srvconfig_"+id}return $(name).hasClass("shown")?($(this).html("Show Config"),$(name).hide(),$(name).removeClass("shown")):($(this).html("Hide Config"),$(name).show(),$(name).addClass("shown")),!1}),$(".deactivatemod").click(function(){var id=$(this).parents("form").find("input[name='id']").val(),type=$(this).parents("form").find("input[name='type']").val();$("#qc_update").addLoader(),ajax_update("?action=saveqc&make=deactivate",{id:id,qc_page:type},"#qc_update")}),$(".savemod").click(function(){var id=$(this).parents("form").find("input[name='id']").val(),type=$(this).parents("form").find("input[name='type']").val(),config=$(this).parents("form").serialize();$("#qc_update").addLoader(),ajax_update("?action=saveqc&make=savemodule&"+config,{id:id,qc_page:type},"#qc_update")}),$(".saveserver").click(function(){var id=$(this).parents("form").find("input[name='id']").val(),config=$(this).parents("form").serialize();$("#qc_update").addLoader(),ajax_update("?action=saveqc&make=saveserver&"+config,{id:id,qc_page:"Servers"},"#qc_update")}),$(".removeserver").click(function(){var id=$(this).parents("form").find("input[name='id']").val();confirm("Do You really want to remove this server?")&&($("#qc_update").addLoader(),ajax_update("?action=saveqc&make=removeserver",{id:id,qc_page:"Servers"},"#qc_update"))})}function send_msg(type){return"clients"==type&&$("input[class=check]:checked").length<1||"allclients"!=type&&0==$("input[class=check]:checked").length?(alert("Nothing checked."),!1):($("#testform").removeAttr("action"),$("#testform").attr("action","?cmd=sendmessage"),$("#testform").append('<input type="hidden" name="type" value="'+type+'" />'),$("#testform").submit(),!1)}var timing=0,t="",maximum=10,num_errors=0,num_infos=0;Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Date.abbrDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.abbrMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Date.firstDayOfWeek=1,Date.format="dd/mm/yyyy",Date.fullYearStart="20",function(){function add(name,method){Date.prototype[name]||(Date.prototype[name]=method)}add("isLeapYear",function(){var y=this.getFullYear();return y%4==0&&y%100!=0||y%400==0}),add("isWeekend",function(){return 0==this.getDay()||6==this.getDay()}),add("isWeekDay",function(){return!this.isWeekend()}),add("getDaysInMonth",function(){return[31,this.isLeapYear()?29:28,31,30,31,30,31,31,30,31,30,31][this.getMonth()]}),add("getDayName",function(abbreviated){return abbreviated?Date.abbrDayNames[this.getDay()]:Date.dayNames[this.getDay()]}),add("getMonthName",function(abbreviated){return abbreviated?Date.abbrMonthNames[this.getMonth()]:Date.monthNames[this.getMonth()]}),add("getDayOfYear",function(){var tmpdtm=new Date("1/1/"+this.getFullYear());return Math.floor((this.getTime()-tmpdtm.getTime())/864e5)}),add("getWeekOfYear",function(){return Math.ceil(this.getDayOfYear()/7)}),add("setDayOfYear",function(day){return this.setMonth(0),this.setDate(day),this}),add("addYears",function(num){return this.setFullYear(this.getFullYear()+num),this}),add("addMonths",function(num){var tmpdtm=this.getDate();return this.setMonth(this.getMonth()+num),tmpdtm>this.getDate()&&this.addDays(-this.getDate()),this}),add("addDays",function(num){return this.setTime(this.getTime()+864e5*num),this}),add("addHours",function(num){return this.setHours(this.getHours()+num),this}),add("addMinutes",function(num){return this.setMinutes(this.getMinutes()+num),this}),add("addSeconds",function(num){return this.setSeconds(this.getSeconds()+num),this}),add("zeroTime",function(){return this.setMilliseconds(0),this.setSeconds(0),this.setMinutes(0),this.setHours(0),this}),add("asString",function(format){var r=format||Date.format;return r.split("yyyy").join(this.getFullYear()).split("yy").join((this.getFullYear()+"").substring(2)).split("mmmm").join(this.getMonthName(!1)).split("mmm").join(this.getMonthName(!0)).split("mm").join(_zeroPad(this.getMonth()+1)).split("dd").join(_zeroPad(this.getDate())).split("hh").join(_zeroPad(this.getHours())).split("min").join(_zeroPad(this.getMinutes())).split("ss").join(_zeroPad(this.getSeconds()))}),Date.fromString=function(s,format){var f=format||Date.format,d=new Date("01/01/1977"),mLength=0,iM=f.indexOf("mmmm");if(iM>-1){for(var i=0;i<Date.monthNames.length;i++){var mStr=s.substr(iM,Date.monthNames[i].length);if(Date.monthNames[i]==mStr){mLength=Date.monthNames[i].length-4;break}}d.setMonth(i)}else if(iM=f.indexOf("mmm"),iM>-1){for(var mStr=s.substr(iM,3),i=0;i<Date.abbrMonthNames.length&&Date.abbrMonthNames[i]!=mStr;i++);d.setMonth(i)}else d.setMonth(Number(s.substr(f.indexOf("mm"),2))-1);var iY=f.indexOf("yyyy");iY>-1?(iY>iM&&(iY+=mLength),d.setFullYear(Number(s.substr(iY,4)))):(iY>iM&&(iY+=mLength),d.setFullYear(Number(Date.fullYearStart+s.substr(f.indexOf("yy"),2))));var iD=f.indexOf("dd");return iD>iM&&(iD+=mLength),d.setDate(Number(s.substr(iD,2))),isNaN(d.getTime())?!1:d};var _zeroPad=function(num){var s="0"+num;return s.substring(s.length-2)}}(),function($){function DatePicker(ele){this.ele=ele,this.displayedMonth=null,this.displayedYear=null,this.startDate=null,this.endDate=null,this.showYearNavigation=null,this.closeOnSelect=null,this.displayClose=null,this.rememberViewedMonth=null,this.selectMultiple=null,this.numSelectable=null,this.numSelected=null,this.verticalPosition=null,this.horizontalPosition=null,this.verticalOffset=null,this.horizontalOffset=null,this.button=null,this.renderCallback=[],this.selectedDates={},this.inline=null,this.context="#dp-popup",this.settings={}}function _getController(ele){return ele._dpId?$.event._dpCache[ele._dpId]:!1}$.fn.extend({renderCalendar:function(s){var dc=function(a){return document.createElement(a)};if(s=$.extend({},$.fn.datePicker.defaults,s),s.showHeader!=$.dpConst.SHOW_HEADER_NONE)for(var headRow=$(dc("tr")),i=Date.firstDayOfWeek;i<Date.firstDayOfWeek+7;i++){var weekday=i%7,day=Date.dayNames[weekday];headRow.append(jQuery(dc("th")).attr({scope:"col",abbr:day,title:day,"class":0==weekday||6==weekday?"weekend":"weekday"}).html(s.showHeader==$.dpConst.SHOW_HEADER_SHORT?day.substr(0,1):day))}var calendarTable=$(dc("table")).attr({cellspacing:2}).addClass("jCalendar").append(s.showHeader!=$.dpConst.SHOW_HEADER_NONE?$(dc("thead")).append(headRow):dc("thead")),tbody=$(dc("tbody")),today=(new Date).zeroTime();today.setHours(12);var month=void 0==s.month?today.getMonth():s.month,year=s.year||today.getFullYear(),currentDate=new Date(year,month,1,12,0,0),firstDayOffset=Date.firstDayOfWeek-currentDate.getDay()+1;firstDayOffset>1&&(firstDayOffset-=7);var weeksToDraw=Math.ceil((-1*firstDayOffset+1+currentDate.getDaysInMonth())/7);currentDate.addDays(firstDayOffset-1);for(var doHover=function(firstDayInBounds){return function(){if(s.hoverClass){var $this=$(this);s.selectWeek?firstDayInBounds&&!$this.is(".disabled")&&$this.parent().addClass("activeWeekHover"):$this.addClass(s.hoverClass)}}},unHover=function(){if(s.hoverClass){var $this=$(this);$this.removeClass(s.hoverClass),$this.parent().removeClass("activeWeekHover")}},w=0;w++<weeksToDraw;){for(var r=jQuery(dc("tr")),firstDayInBounds=s.dpController?currentDate>s.dpController.startDate:!1,i=0;7>i;i++){var thisMonth=currentDate.getMonth()==month,d=$(dc("td")).text(currentDate.getDate()+"").addClass((thisMonth?"current-month ":"other-month ")+(currentDate.isWeekend()?"weekend ":"weekday ")+(thisMonth&&currentDate.getTime()==today.getTime()?"today ":"")).data("datePickerDate",currentDate.asString()).hover(doHover(firstDayInBounds),unHover);r.append(d),s.renderCallback&&s.renderCallback(d,currentDate,month,year),currentDate=new Date(currentDate.getFullYear(),currentDate.getMonth(),currentDate.getDate()+1,12,0,0)}tbody.append(r)}return calendarTable.append(tbody),this.each(function(){$(this).empty().append(calendarTable)})},datePicker:function(s){return $.event._dpCache||($.event._dpCache=[]),s=$.extend({},$.fn.datePicker.defaults,s),this.each(function(){var $this=$(this),alreadyExists=!0;this._dpId||(this._dpId=$.guid++,$.event._dpCache[this._dpId]=new DatePicker(this),alreadyExists=!1),s.inline&&(s.createButton=!1,s.displayClose=!1,s.closeOnSelect=!1,$this.empty());var controller=$.event._dpCache[this._dpId];if(controller.init(s),!alreadyExists&&s.createButton&&(controller.button=$('<a href="#" class="dp-choose-date" title="'+$.dpText.TEXT_CHOOSE_DATE+'">'+$.dpText.TEXT_CHOOSE_DATE+"</a>").bind("click",function(){return $this.dpDisplay(this),this.blur(),!1}),$this.after(controller.button)),!alreadyExists&&$this.is(":text")){$this.bind("dateSelected",function(e,selectedDate,$td){this.value=selectedDate.asString()}).bind("change",function(){if(""==this.value)controller.clearSelected();else{var d=Date.fromString(this.value);d&&controller.setSelected(d,!0,!0)}}),s.clickInput&&$this.bind("click",function(){$this.trigger("change"),$this.dpDisplay()});var d=Date.fromString(this.value);""!=this.value&&d&&controller.setSelected(d,!0,!0)}$this.addClass("dp-applied")})},dpSetDisabled:function(s){return _w.call(this,"setDisabled",s)},dpSetStartDate:function(d){return _w.call(this,"setStartDate",d)},dpSetEndDate:function(d){return _w.call(this,"setEndDate",d)},dpGetSelected:function(){var c=_getController(this[0]);return c?c.getSelected():null},dpSetSelected:function(d,v,m,e){return void 0==v&&(v=!0),void 0==m&&(m=!0),void 0==e&&(e=!0),_w.call(this,"setSelected",Date.fromString(d),v,m,e)},dpSetDisplayedMonth:function(m,y){return _w.call(this,"setDisplayedMonth",Number(m),Number(y),!0)},dpDisplay:function(e){return _w.call(this,"display",e)},dpSetRenderCallback:function(a){return _w.call(this,"setRenderCallback",a)},dpSetPosition:function(v,h){return _w.call(this,"setPosition",v,h)},dpSetOffset:function(v,h){return _w.call(this,"setOffset",v,h)},dpClose:function(){return _w.call(this,"_closeCalendar",!1,this[0])},dpRerenderCalendar:function(){return _w.call(this,"_rerenderCalendar")},_dpDestroy:function(){}});var _w=function(f,a1,a2,a3,a4){return this.each(function(){var c=_getController(this);c&&c[f](a1,a2,a3,a4)})};$.extend(DatePicker.prototype,{init:function(s){this.setStartDate(s.startDate),this.setEndDate(s.endDate),this.setDisplayedMonth(Number(s.month),Number(s.year)),this.setRenderCallback(s.renderCallback),this.showYearNavigation=s.showYearNavigation,this.closeOnSelect=s.closeOnSelect,this.displayClose=s.displayClose,this.rememberViewedMonth=s.rememberViewedMonth,this.selectMultiple=s.selectMultiple,this.numSelectable=s.selectMultiple?s.numSelectable:1,this.numSelected=0,this.verticalPosition=s.verticalPosition,this.horizontalPosition=s.horizontalPosition,this.hoverClass=s.hoverClass,this.setOffset(s.verticalOffset,s.horizontalOffset),this.inline=s.inline,this.settings=s,this.inline&&(this.context=this.ele,this.display())},setStartDate:function(d){d&&(this.startDate=Date.fromString(d)),this.startDate||(this.startDate=(new Date).zeroTime()),this.setDisplayedMonth(this.displayedMonth,this.displayedYear)},setEndDate:function(d){d&&(this.endDate=Date.fromString(d)),this.endDate||(this.endDate=new Date("12/31/2999")),this.endDate.getTime()<this.startDate.getTime()&&(this.endDate=this.startDate),this.setDisplayedMonth(this.displayedMonth,this.displayedYear)},setPosition:function(v,h){this.verticalPosition=v,this.horizontalPosition=h},setOffset:function(v,h){this.verticalOffset=parseInt(v)||0,this.horizontalOffset=parseInt(h)||0},setDisabled:function(s){$e=$(this.ele),$e[s?"addClass":"removeClass"]("dp-disabled"),this.button&&($but=$(this.button),$but[s?"addClass":"removeClass"]("dp-disabled"),$but.attr("title",s?"":$.dpText.TEXT_CHOOSE_DATE)),$e.is(":text")&&$e.attr("disabled",s?"disabled":"")},setDisplayedMonth:function(m,y,rerender){if(void 0!=this.startDate&&void 0!=this.endDate){var s=new Date(this.startDate.getTime());s.setDate(1);var e=new Date(this.endDate.getTime());e.setDate(1);var t;!m&&!y||isNaN(m)&&isNaN(y)?(t=(new Date).zeroTime(),t.setDate(1)):t=isNaN(m)?new Date(y,this.displayedMonth,1):isNaN(y)?new Date(this.displayedYear,m,1):new Date(y,m,1),t.getTime()<s.getTime()?t=s:t.getTime()>e.getTime()&&(t=e);var oldMonth=this.displayedMonth,oldYear=this.displayedYear;this.displayedMonth=t.getMonth(),this.displayedYear=t.getFullYear(),!rerender||this.displayedMonth==oldMonth&&this.displayedYear==oldYear||(this._rerenderCalendar(),$(this.ele).trigger("dpMonthChanged",[this.displayedMonth,this.displayedYear]))}},setSelected:function(d,v,moveToMonth,dispatchEvents){if(!(d<this.startDate||d.zeroTime()>this.endDate.zeroTime())){var s=this.settings;if(!(s.selectWeek&&(d=d.addDays(-(d.getDay()-Date.firstDayOfWeek+7)%7),d<this.startDate))&&v!=this.isSelected(d)){if(0==this.selectMultiple)this.clearSelected();else if(v&&this.numSelected==this.numSelectable)return;!moveToMonth||this.displayedMonth==d.getMonth()&&this.displayedYear==d.getFullYear()||this.setDisplayedMonth(d.getMonth(),d.getFullYear(),!0),this.selectedDates[d.asString()]=v,this.numSelected+=v?1:-1;var $td,selectorString="td."+(d.getMonth()==this.displayedMonth?"current-month":"other-month");if($(selectorString,this.context).each(function(){$(this).data("datePickerDate")==d.asString()&&($td=$(this),s.selectWeek&&$td.parent()[v?"addClass":"removeClass"]("selectedWeek"),$td[v?"addClass":"removeClass"]("selected"))}),$("td",this.context).not(".selected")[this.selectMultiple&&this.numSelected==this.numSelectable?"addClass":"removeClass"]("unselectable"),dispatchEvents){var s=this.isSelected(d);$e=$(this.ele);var dClone=Date.fromString(d.asString());$e.trigger("dateSelected",[dClone,$td,s]),$e.trigger("change")}}}},isSelected:function(d){return this.selectedDates[d.asString()]},getSelected:function(){var r=[];for(var s in this.selectedDates)1==this.selectedDates[s]&&r.push(Date.fromString(s));return r},clearSelected:function(){this.selectedDates={},this.numSelected=0,$("td.selected",this.context).removeClass("selected").parent().removeClass("selectedWeek")},display:function(eleAlignTo){if(!$(this.ele).is(".dp-disabled")){eleAlignTo=eleAlignTo||this.ele;var $createIn,attrs,cssRules,c=this,$ele=$(eleAlignTo),eleOffset=$ele.offset();if(c.inline)$createIn=$(this.ele),attrs={id:"calendar-"+this.ele._dpId,"class":"dp-popup dp-popup-inline"},$(".dp-popup",$createIn).remove(),cssRules={};else{$createIn=$("body"),attrs={id:"dp-popup","class":"dp-popup"},cssRules={top:eleOffset.top+c.verticalOffset,left:eleOffset.left+c.horizontalOffset};var _checkMouse=function(e){for(var el=e.target,cal=$("#dp-popup")[0];;){if(el==cal)return!0;if(el==document)return c._closeCalendar(),!1;el=$(el).parent()[0]}};this._checkMouse=_checkMouse,c._closeCalendar(!0),$(document).bind("keydown.datepicker",function(event){27==event.keyCode&&c._closeCalendar()})}if(!c.rememberViewedMonth){var selectedDate=this.getSelected()[0];selectedDate&&(selectedDate=new Date(selectedDate),
this.setDisplayedMonth(selectedDate.getMonth(),selectedDate.getFullYear(),!1))}$createIn.append($("<div></div>").attr(attrs).css(cssRules).append($("<h2></h2>"),$('<div class="dp-nav-prev"></div>').append($('<a class="dp-nav-prev-year" href="#" title="'+$.dpText.TEXT_PREV_YEAR+'">&lt;&lt;</a>').bind("click",function(){return c._displayNewMonth.call(c,this,0,-1)}),$('<a class="dp-nav-prev-month" href="#" title="'+$.dpText.TEXT_PREV_MONTH+'">&lt;</a>').bind("click",function(){return c._displayNewMonth.call(c,this,-1,0)})),$('<div class="dp-nav-next"></div>').append($('<a class="dp-nav-next-year" href="#" title="'+$.dpText.TEXT_NEXT_YEAR+'">&gt;&gt;</a>').bind("click",function(){return c._displayNewMonth.call(c,this,0,1)}),$('<a class="dp-nav-next-month" href="#" title="'+$.dpText.TEXT_NEXT_MONTH+'">&gt;</a>').bind("click",function(){return c._displayNewMonth.call(c,this,1,0)})),$('<div class="dp-calendar"></div>')).bgIframe());var $pop=this.inline?$(".dp-popup",this.context):$("#dp-popup");0==this.showYearNavigation&&$(".dp-nav-prev-year, .dp-nav-next-year",c.context).css("display","none"),this.displayClose&&$pop.append($('<a href="#" id="dp-close">'+$.dpText.TEXT_CLOSE+"</a>").bind("click",function(){return c._closeCalendar(),!1})),c._renderCalendar(),$(this.ele).trigger("dpDisplayed",$pop),c.inline||(this.verticalPosition==$.dpConst.POS_BOTTOM&&$pop.css("top",eleOffset.top+$ele.height()-$pop.height()+c.verticalOffset),this.horizontalPosition==$.dpConst.POS_RIGHT&&$pop.css("left",eleOffset.left+$ele.width()-$pop.width()+c.horizontalOffset),$(document).bind("mousedown.datepicker",this._checkMouse))}},setRenderCallback:function(a){null!=a&&(a&&"function"==typeof a&&(a=[a]),this.renderCallback=this.renderCallback.concat(a))},cellRender:function($td,thisDate,month,year){var c=this.dpController,d=new Date(thisDate.getTime());$td.bind("click",function(){var $this=$(this);if(!$this.is(".disabled")&&(c.setSelected(d,!$this.is(".selected")||!c.selectMultiple,!1,!0),c.closeOnSelect)){if(c.settings.autoFocusNextInput){var ele=c.ele,found=!1;$(":input",ele.form).each(function(){return found?($(this).focus(),!1):void(this==ele&&(found=!0))})}else c.ele.focus();c._closeCalendar()}}),c.isSelected(d)?($td.addClass("selected"),c.settings.selectWeek&&$td.parent().addClass("selectedWeek")):c.selectMultiple&&c.numSelected==c.numSelectable&&$td.addClass("unselectable")},_applyRenderCallbacks:function(){var c=this;$("td",this.context).each(function(){for(var i=0;i<c.renderCallback.length;i++)$td=$(this),c.renderCallback[i].apply(this,[$td,Date.fromString($td.data("datePickerDate")),c.displayedMonth,c.displayedYear])})},_displayNewMonth:function(ele,m,y){return $(ele).is(".disabled")||this.setDisplayedMonth(this.displayedMonth+m,this.displayedYear+y,!0),ele.blur(),!1},_rerenderCalendar:function(){this._clearCalendar(),this._renderCalendar()},_renderCalendar:function(){if($("h2",this.context).html(new Date(this.displayedYear,this.displayedMonth,1).asString($.dpText.HEADER_FORMAT)),$(".dp-calendar",this.context).renderCalendar($.extend({},this.settings,{month:this.displayedMonth,year:this.displayedYear,renderCallback:this.cellRender,dpController:this,hoverClass:this.hoverClass})),this.displayedYear==this.startDate.getFullYear()&&this.displayedMonth==this.startDate.getMonth()){$(".dp-nav-prev-year",this.context).addClass("disabled"),$(".dp-nav-prev-month",this.context).addClass("disabled"),$(".dp-calendar td.other-month",this.context).each(function(){var $this=$(this);Number($this.text())>20&&$this.addClass("disabled")});var d=this.startDate.getDate();$(".dp-calendar td.current-month",this.context).each(function(){var $this=$(this);Number($this.text())<d&&$this.addClass("disabled")})}else{$(".dp-nav-prev-year",this.context).removeClass("disabled"),$(".dp-nav-prev-month",this.context).removeClass("disabled");var d=this.startDate.getDate();if(d>20){var st=this.startDate.getTime(),sd=new Date(st);sd.addMonths(1),this.displayedYear==sd.getFullYear()&&this.displayedMonth==sd.getMonth()&&$(".dp-calendar td.other-month",this.context).each(function(){var $this=$(this);Date.fromString($this.data("datePickerDate")).getTime()<st&&$this.addClass("disabled")})}}if(this.displayedYear==this.endDate.getFullYear()&&this.displayedMonth==this.endDate.getMonth()){$(".dp-nav-next-year",this.context).addClass("disabled"),$(".dp-nav-next-month",this.context).addClass("disabled"),$(".dp-calendar td.other-month",this.context).each(function(){var $this=$(this);Number($this.text())<14&&$this.addClass("disabled")});var d=this.endDate.getDate();$(".dp-calendar td.current-month",this.context).each(function(){var $this=$(this);Number($this.text())>d&&$this.addClass("disabled")})}else{$(".dp-nav-next-year",this.context).removeClass("disabled"),$(".dp-nav-next-month",this.context).removeClass("disabled");var d=this.endDate.getDate();if(13>d){var ed=new Date(this.endDate.getTime());ed.addMonths(-1),this.displayedYear==ed.getFullYear()&&this.displayedMonth==ed.getMonth()&&$(".dp-calendar td.other-month",this.context).each(function(){var $this=$(this),cellDay=Number($this.text());13>cellDay&&cellDay>d&&$this.addClass("disabled")})}}this._applyRenderCallbacks()},_closeCalendar:function(programatic,ele){ele&&ele!=this.ele||($(document).unbind("mousedown.datepicker"),$(document).unbind("keydown.datepicker"),this._clearCalendar(),$("#dp-popup a").unbind(),$("#dp-popup").empty().remove(),programatic||$(this.ele).trigger("dpClosed",[this.getSelected()]))},_clearCalendar:function(){$(".dp-calendar td",this.context).unbind(),$(".dp-calendar",this.context).empty()}}),$.dpConst={SHOW_HEADER_NONE:0,SHOW_HEADER_SHORT:1,SHOW_HEADER_LONG:2,POS_TOP:0,POS_BOTTOM:1,POS_LEFT:0,POS_RIGHT:1,DP_INTERNAL_FOCUS:"dpInternalFocusTrigger"},$.dpText={TEXT_PREV_YEAR:"Previous year",TEXT_PREV_MONTH:"Previous month",TEXT_NEXT_YEAR:"Next year",TEXT_NEXT_MONTH:"Next month",TEXT_CLOSE:"Close",TEXT_CHOOSE_DATE:"Choose date",HEADER_FORMAT:"mmmm yyyy"},$.dpVersion="$Id: jquery.datePicker.js 102 2010-09-13 14:00:54Z kelvin.luck $",$.fn.datePicker.defaults={month:void 0,year:void 0,showHeader:$.dpConst.SHOW_HEADER_SHORT,startDate:void 0,endDate:void 0,inline:!1,renderCallback:null,createButton:!0,showYearNavigation:!0,closeOnSelect:!0,displayClose:!1,selectMultiple:!1,numSelectable:Number.MAX_VALUE,clickInput:!1,rememberViewedMonth:!0,selectWeek:!1,verticalPosition:$.dpConst.POS_TOP,horizontalPosition:$.dpConst.POS_LEFT,verticalOffset:0,horizontalOffset:0,hoverClass:"dp-hover",autoFocusNextInput:!1},void 0==$.fn.bgIframe&&($.fn.bgIframe=function(){return this}),$(window).bind("unload",function(){var els=$.event._dpCache||[];for(var i in els)$(els[i].ele)._dpDestroy()})}(jQuery),jQuery.fn.pagination=function(maxentries,opts){function getInterval(){var ne_half=Math.ceil(opts.num_display_entries/2),np=maxentries,upper_limit=np-opts.num_display_entries,start=current_page>ne_half?Math.max(Math.min(current_page-ne_half,upper_limit),0):0,end=current_page>ne_half?Math.min(current_page+ne_half,np):Math.min(opts.num_display_entries,np);return[start,end]}function pageSelected(page_id,evt){current_page=page_id,drawLinks();var continuePropagation=opts.callback(page_id);return continuePropagation||(evt.stopPropagation?evt.stopPropagation():evt.cancelBubble=!0),continuePropagation}function drawLinks(){containers.each(function(){var panel=jQuery(this);panel.empty();var interval=getInterval(),np=maxentries,getClickHandler=function(page_id){return function(evt){return pageSelected(page_id,evt)}},appendItem=function(page_id,appendopts){if(page_id=0>page_id?0:np>page_id?page_id:np-1,appendopts=jQuery.extend({text:page_id+1,classes:""},appendopts||{}),page_id==current_page)var lnk=jQuery("<span class='current'>"+appendopts.text+"</span>");else var lnk=jQuery("<a>"+appendopts.text+"</a>").bind("click",getClickHandler(page_id)).attr("href",opts.link_to.replace(/__id__/,page_id));appendopts.classes&&lnk.addClass(appendopts.classes),panel.append(lnk)};if(opts.prev_text&&(current_page>0||opts.prev_show_always)&&appendItem(current_page-1,{text:opts.prev_text,classes:"prev"}),interval[0]>0&&opts.num_edge_entries>0){for(var end=Math.min(opts.num_edge_entries,interval[0]),i=0;end>i;i++)appendItem(i);opts.num_edge_entries<interval[0]&&opts.ellipse_text&&jQuery("<span>"+opts.ellipse_text+"</span>").appendTo(panel)}for(var i=interval[0];i<interval[1];i++)appendItem(i);if(interval[1]<np&&opts.num_edge_entries>0){np-opts.num_edge_entries>interval[1]&&opts.ellipse_text&&jQuery("<span>"+opts.ellipse_text+"</span>").appendTo(panel);for(var begin=Math.max(np-opts.num_edge_entries,interval[1]),i=begin;np>i;i++)appendItem(i)}opts.next_text&&(np-1>current_page||opts.next_show_always)&&appendItem(current_page+1,{text:opts.next_text,classes:"next"})})}if(jQuery.fn.pagination.setPage=function(x){current_page=parseInt(x),drawLinks()},void 0!=maxentries&&0!=maxentries){opts=jQuery.extend({initial_page:0,num_display_entries:4,current_page:0,num_edge_entries:1,link_to:"#",prev_text:"&lt;",next_text:"&gt;",ellipse_text:"...",prev_show_always:!1,next_show_always:!1,callback:function(index){return $("#updater").addLoader(),$("#checkall").attr("checked",!1),$.post($("#currentlist").attr("href"),{page:index},function(data){var resp=parse_response(data);resp&&($("#updater").html(resp),$(".check").unbind("click"),$(".currentpage").val(index),$(".check").click(checkEl))}),!1}},opts||{});var current_page=opts.current_page;maxentries=!maxentries||0>maxentries?1:maxentries,opts.items_per_page=!opts.items_per_page||opts.items_per_page<0?1:opts.items_per_page;var containers=this;drawLinks(),current_page!=opts.initial_page&&opts.callback(current_page)}},function(a){a.event.special.textchange={setup:function(){a(this).bind("keyup.textchange",a.event.special.textchange.handler),a(this).bind("cut.textchange paste.textchange input.textchange",a.event.special.textchange.delayedHandler)},teardown:function(){a(this).unbind(".textchange")},handler:function(){a.event.special.textchange.triggerIfChanged(a(this))},delayedHandler:function(){var b=a(this);setTimeout(function(){a.event.special.textchange.triggerIfChanged(b)},25)},triggerIfChanged:function(b){var c=b.attr("contenteditable")?b.html():b.val();c!==b.data("lastValue")&&(b.trigger("textchange",b.data("lastValue")),b.data("lastValue",c))}}}(jQuery),$.fn.serializeObject=function(){var o={},a=this.serializeArray();return $.each(a,function(){void 0!==o[this.name]?(o[this.name].push||(o[this.name]=[o[this.name]]),o[this.name].push(this.value||"")):o[this.name]=this.value||""}),o},$.extend($.fn,{vTip:function(target){var xOffset=5,yOffset=2;$(this).not(".vtip_applied").hover(function(e){this.t=this.title,this.title="",this.top=e.pageY+yOffset,this.left=e.pageX+xOffset,$("body").append('<p id="vtip">'+this.t+"</p>"),$("p#vtip").css("top",this.top+"px").css("left",this.left+"px").fadeIn("fast")},function(){this.title=this.t,$("p#vtip").hide().remove()}).addClass("vtip_applied")},slideToElement:function(target){var $target=$("a[name="+target+"]");if($target.length){var targetOffset=$target.offset().top;return $("html,body").animate({scrollTop:targetOffset-100},500,"linear",function(){}),!1}},dropdownMenu:function(o,callback){return $(this).click(function(event){event.preventDefault();var menu=$(this),activated=menu.hasClass("activated"),listId=menu.attr("id"),menuOffset=menu.offset(),menuHeight=menu.outerHeight(),w=$(window),scrollTop=w.scrollTop(),windowHeight=w.height(),offset=$.extend({},menuOffset);if(menu.is(".disabled"))return!1;if($(".contextMenu").hide(),$(".dropdown-menu-on").removeClass("dropdown-menu-on activated"),activated)return!1;if(menu.addClass("activated dropdown-menu-on"),listId){offset.top+=menuHeight;var list=$("#"+listId+"_m");list.addClass("contextMenu").show().find("a").unbind(".dropdown").bind("click.dropdown",function(e){var a=$(this),li=a.parent();return menu.removeClass("activated"),$(".contextMenu").hide(),$(document).unbind(".dropdown"),li.is(".disabled")?!1:a.is(".directly")?(a.unbind(".dropdown").click(),!0):("function"==typeof callback&&callback(a.attr("href"),menu,e,a.html()),!1)});var listHeight=list.outerHeight();if(scrollTop+windowHeight<menuOffset.top+menuHeight+listHeight)if(menuOffset.top-listHeight>scrollTop)offset.top=menuOffset.top-listHeight;else{var limHeight=Math.max(scrollTop+windowHeight-(menuOffset.top+menuHeight),menuOffset.top-scrollTop),targetHeight=30,group=[[]],gi=0,filter=function(){return!$(this).hasClass("wrapp")};list.find("> li, .wrapp > ul > li").filter(filter).each(function(){var li=$(this);limHeight>targetHeight?targetHeight+=li.height():(targetHeight=li.height()+30,gi++,group[gi]=[]),group[gi].push(li.detach())}),list.children().remove();for(var i=0;i<group.length;i++){var wrapp=$('<li class="wrapp"><ul></ul></li>');wrapp.appendTo(list).find("ul").append(group[i])}list.width(160*group.length),listHeight=list.outerHeight(),menuOffset.top-listHeight>scrollTop&&(offset.top=menuOffset.top-listHeight)}var listWidth=list.outerWidth();offset.left+listWidth>w.width()&&(offset.left-=offset.left+listWidth-w.width()),list.offset(offset)}return $(document).unbind(".dropdown").bind("click.dropdown keypress.dropdown",function(e){return(27==e.keyCode||!menu.is(e.target)&&!menu.find(e.target).length)&&($(document).unbind(".dropdown"),list.hide(),menu.removeClass("activated dropdown-menu-on")),!1}),!1}),$(this)},SmartSearch:function(o,callback){var defaults={target:"#smartres",url:"?cmd=search&lightweight=1",submitel:"#search_submiter",results:"#smartres-results",container:"#search_form_container"};return o=$.extend({},defaults,o||{}),$(this).each(function(){var el=$(this),offset=$(el).offset(),height=$(el).height(),x=offset.left,y=height+offset.top+4,ending_right=($(el).position().left,$(el).position().top+4+height,$(window).width()-(x+el.outerWidth()));$(o.target).css({top:y,right:ending_right}),$(o.submitel).click(function(){return $(this).addClass("search_loading"),$.post(o.url,{query:el.val()},function(data){$(o.submitel).removeClass("search_loading");var resp=parse_response(data);resp!==!1&&"string"==typeof resp?el.SmartSearchShow(resp,el.val(),o):el.SmartSearchHide(o)}),!1}),$(this).keydown(function(event){13==event.keyCode&&$(o.submitel).click()})}),$(this)},ShowNicely:function(){var e=$(this);return e.addClass("shownice").show(),setTimeout(function(el){$(e).removeClass("shownice")},1e3,e),$(this)},scrollToEl:function(){if($(this).length){var targetOffset=$(this).offset().top;$("html,body").animate({scrollTop:targetOffset-100},500,"linear",function(){})}return $(this)},SmartSearchHide:function(o){return $(o.target).fadeOut("fast",function(){$(o.results).html("")}),$(o.container).removeClass("resultsin"),$(this)},SmartSearchShow:function(content,term,o){$(o.results).html(content);var t=term.split(" ");for(var i in t)$("li.result",o.results).highlight(t[i].replace("*",""),{className:"h"});$(o.container).addClass("resultsin"),$(o.target).fadeIn("fast");var el=$(this);return $(document).click(function(){return $(document).unbind("click"),el.SmartSearchHide(o),!1}),$("a",o.target).click(function(e){return!0}).mousedown(function(e){return e.stopPropagation(),2==e.which&&(e.preventDefault(),$(this).attr("target","_blank").click().removeAttr("target")),$(this).click(),!0}),$(this)},HoverMenu:function(o,callback){return $(this).each(function(n){var el=$(this),offset=el.offset(),height=el.height(),x=offset.left,y=height+offset.top;$(".submenu","#menushelf").eq(n).css({top:y,left:x}),el.hover(function(){$(this).HoverMenuShow(n)},function(){$(this).HoverTimer()})}),$(".submenu","#menushelf").hover(function(){$(this).HoverCancelTimer()},function(){$(this).HoverMenuHide()}),$(this)},TabbedMenu:function(o){var el=o.elem?o.elem:".tabb",choice=o.picker?o.picker:"a.tchoice",activeclass=o.aclass?o.aclass:"picked",picked=o.picked?parseInt(o.picked):0,picker_id=o.picker_id?o.picker_id:"picked_tab",t=$(this);return $(el).hide(),$(el).eq(picked).show(),$(""+choice+":not(.directlink)").eq(picked).addClass(activeclass),t.find("#"+picker_id).length||o.picktab||t.append('<input type="hidden" value="'+picked+'" name="'+picker_id+'" id="'+picker_id+'"/>'),t.find(""+choice+":not(.directlink)").each(function(n){$(this).click(function(){return $(this).hasClass("disabled")?!1:(o.picktab||t.find("#"+picker_id).val(n),$(el).hide(),$(el).eq(n).show(),$(""+choice).removeClass(activeclass),$(this).addClass(activeclass),$(this).find("span.notification").length&&$(this).find("span.notification").removeClass("notification"),!1)})}),$(this)},HoverMenuHide:function(){return $(".mainmenu","#mmcontainer").removeClass("active"),$(".submenu","#menushelf").hide(),$(this)},HoverMenuShow:function(elem){var el=$(this);return el.HoverCancelTimer(),$(".submenu","#menushelf").hide(),$(".mainmenu","#mmcontainer").removeClass("active"),$(".submenu","#menushelf").eq(elem).show(),el.addClass("active"),$(this)},HoverTimer:function(){return timing=setTimeout(function(){$(".mainmenu","#mmcontainer").removeClass("active"),$(".submenu","#menushelf").hide()},200),$(this)},HoverCancelTimer:function(){return timing&&(clearTimeout(timing),timing=null),$(this)},taskMgr:function(o,callback){return $(this).each(function(){$(this).taskMgrCountEI();var el=$(this);el.find("span.progress").progressBar(0,{max:maximum}).addClass("hidden").hide(),el.find("a.showlog").hide(),el.find("a.showlog").mouseover(function(){return el.taskMgrShow(),$(this).hide(),!1}),el.hover(function(){},function(){$(this).taskMgrHide()}),$(this).taskMgrCheckInterval()}),$(this)},taskMgrCountEI:function(){$("LI.info","#taskMGR").length>0?$("#numinfos").html($("LI.info","#taskMGR").length).show():$("#numinfos").html("0"),$("LI.error","#taskMGR").length>0?$("#numerrors").html($("LI.error","#taskMGR").length).show():$("#numerrors").html("0")},taskMgrProgress:function(current){var el=$(this);el.taskMgrCheckVisibility();var prog=$(this).find("span.progress");return 0==parseInt(current)?(prog.progressBar(maximum).fadeOut("fast",function(){el.taskMgrCheckVisibility()}).addClass("hidden").removeClass("visible"),el.taskMgrCountEI()):($("#numinfos").hide(),$("#numerrors").hide(),prog.hasClass("hidden")&&prog.removeClass("hidden").addClass("visible").fadeIn(),prog.progressBar(maximum-parseInt(current),{max:maximum,callback:function(data){data.max==data.running_value&&(prog.fadeOut().addClass("hidden").removeClass("visible"),el.taskMgrCountEI())}})),$(this)},taskMgrAddInfo:function(info){var t=new Date,el=$(this),ss=t.getMinutes();10>ss&&(ss="0"+ss);var s=t.getHours().toString()+":"+ss,i=parseInt($("#numinfos").html());return $("#numinfos").html(i+1).show(),el.find("ul").prepend('<li class="info visible">'+s+" "+info+"<br/></li>"),el.taskMgrCheckInterval(),el.addClass("newel"),$(this)},taskMgrAddError:function(error){var i=parseInt($("#numerrors").html()),t=new Date,el=$(this),ss=t.getMinutes();10>ss&&(ss="0"+ss);var s=t.getHours().toString()+":"+ss;return $("#numerrors").html(i+1).show(),el.find("ul").prepend('<li class="error visible">'+s+" "+error+"<br/></li>"),el.taskMgrCheckInterval(),el.addClass("newel"),$(this)},taskMgrShow:function(){return clearTimeout(t),t="",$(this).addClass("taskAll").find("li").show(),$(this)},taskMgrCheckVisibility:function(){var el=$(this);return el.find("LI").length>0||el.find("span.progress").hasClass("visible")?(el.find("a.showlog").show(),el.show()):el.hide(),$(this)},taskQuickLoadShow:function(){return $(this).find("span.progress").hasClass("visible")||$(this).show().find(".small-load").show(),$(this)},taskQuickLoadHide:function(){return $(this).find(".small-load").hide(),$(this)},taskMgrHide:function(){var el=$(this);return el.removeClass("taskAll"),el.find("li.hidden").hide(),el.find("LI").length>0&&el.find("a.showlog").show(),el.taskMgrCheckInterval()},taskMgrCheckInterval:function(){var el=$(this);el.taskMgrCheckVisibility();var len=el.find("LI.visible").length;return len>0?(navigator.userAgent.match(/MSIE 6/i)&&el.css({top:document.documentElement.scrollTop}),t=setTimeout(function(){"newel taskAll"!=el.attr("class")&&"taskAll"!=el.attr("class")&&($(this).find("LI.visible:last").slideUp("slow",function(){$(this).removeClass("visible").addClass("hidden")}),el.taskMgrCheckInterval())},2e3)):el.removeClass("newel"),$(this)},addLoader:function(margin){var that=this.eq(0),offset=that.position(),loader=$("#preloader").hide();if(null===offset)return this;var totalWidth=that.outerWidth(!!margin),totalHeight=that.outerHeight(!!margin);return margin||(offset.left+=parseInt(that.css("margin-left")),offset.top+=parseInt(that.css("margin-top"))),loader.length&&loader.parent().is(that)?loader.css({width:totalWidth,height:totalHeight,top:offset.top,left:offset.left}).show():(loader.length&&loader.remove(),$('<div id="preloader" ></div>').css({position:"absolute",width:totalWidth,height:totalHeight,top:offset.top,left:offset.left}).appendTo(that)),this},hideLoader:function(){return $("#preloader").hide(),$(this)}}),function($){$.extend({progressBar:new function(){this.defaults={steps:20,step_duration:20,max:100,width:120,height:12,callback:null,boxImage:"images/progressbar.gif",barImage:"images/progressbg_blue.gif",running_value:0,value:0,image:null},this.construct=function(arg1,arg2){var argvalue=null,argconfig=null;return null!=arg1&&(isNaN(arg1)?argconfig=arg1:(argvalue=arg1,null!=arg2&&(argconfig=arg2))),this.each(function(child){function getPercentage(config){return 100*config.running_value/config.max}function getBarImage(config){var image=config.barImage;return image}var pb=this,config=this.config;if(null!=argvalue&&null!=this.bar&&null!=this.config)this.config.value=argvalue,null!=argconfig&&(pb.config=$.extend(this.config,argconfig)),config=pb.config;else{var $this=$(this),config=$.extend({},$.progressBar.defaults,argconfig);config.id=$this[0].id?$this[0].id:Math.ceil(1e5*Math.random()),null==argvalue&&(argvalue=$this.html().replace("%","")),config.value=argvalue,config.running_value=0,config.image=getBarImage(config),$this.html("");var bar=document.createElement("img"),text=document.createElement("span"),$bar=$(bar),$text=$(text);pb.bar=$bar,$bar.attr("id",config.id+"_pbImage"),$text.attr("id",config.id+"_pbText"),$bar.attr("src",config.boxImage),$bar.attr("width",config.width),$bar.css("width",config.width+"px"),$bar.css("height",config.height+"px"),$bar.css("background-image","url("+config.image+")"),$bar.css("background-position",-1*config.width+"px 50%"),$bar.css("padding","0"),$bar.css("margin","0"),$this.append($bar),$this.append($text)}config.increment=Math.round((config.value-config.running_value)/config.steps),config.increment<0&&(config.increment*=-1),config.increment<1&&(config.increment=1);var t=setInterval(function(){var pixels=config.width/100;config.running_value>config.value?config.running_value-config.increment<config.value?config.running_value=config.value:config.running_value-=config.increment:config.running_value<config.value&&(config.running_value+config.increment>config.value?config.running_value=config.value:config.running_value+=config.increment),config.running_value==config.value&&clearInterval(t);var $bar=$("#"+config.id+"_pbImage"),image=($("#"+config.id+"_pbText"),getBarImage(config));image!=config.image&&($bar.css("background-image","url("+image+")"),config.image=image),$bar.css("background-position",-1*config.width+getPercentage(config)*pixels+"px 50%"),null!=config.callback&&"function"==typeof config.callback&&config.callback(config),pb.config=config},config.step_duration)})}}}),$.fn.extend({progressBar:$.progressBar.construct})}(jQuery);var initload=0,loadelements={tickets:!1,invoices:!1,services:!1,accounts:!1,domains:!1,clients:!1,emails:!1,estimates:!1,neworder:!1,loaders:new Array};$(window).load(function(){function CSRFProtection(xhr){var token=$('meta[name="csrf-token"]').attr("content");token&&xhr.setRequestHeader("X-CSRF-Token",token)}"ajaxPrefilter"in $?$.ajaxPrefilter(function(options,originalOptions,xhr){CSRFProtection(xhr)}):$(document).ajaxSend(function(e,xhr){CSRFProtection(xhr)}),$.ajaxSetup({cache:!0}),$("#taskMGR").taskMgr(),$("#smarts").SmartSearch(),pops(),$(".fadvanced").click(function(){return""==$("#hider").html()?(ajax_update($(this).attr("href"),{},"#hider"),$("#hider2").hide(),$("#hider").show()):($("#hider").show(),$("#hider2").hide()),!1}),$("a.tload").click(function(){return $(this).hasClass("tstyled")&&($("body").find("a.tload").removeClass("selected"),$(this).addClass("selected")),window.clearInterval(checkUrlInval),window.location.hash="",ajax_update($(this).attr("href"),{},"#bodycont"),!1}),bindEvents();var loadelements_cp=loadelements;loadelements_cp.tickets&&bindTicketEvents(),loadelements_cp.invoices&&bindInvoiceEvents(),loadelements_cp.estimates&&bindEstimatesEvents(),loadelements_cp.services&&bindServicesEvents(),loadelements_cp.accounts&&bindAccountEvents(),loadelements_cp.domains&&bindDomainEvents(),loadelements_cp.clients&&bindClientEvents(),loadelements_cp.neworder&&bindNewOrderEvents();var l1a=loadelements_cp.loaders,ll=l1a.length;if(ll>0){var i=0;for(i=0;ll>i;i++)eval(l1a[i]+"()")}});var checkUrlInval="",HBInputTranslate={};HBInputTranslate.addTranslation=function(id){return $.getJSON("?cmd=langedit",{action:"quicktag"},function(data){var x=$("#"+id);if(console.log(id,x,x.data("ace"),x.data("aceeditor")),x.is("input")){var v=x.val();x.val(v+""+data.taglink)}else if(x.hasClass("tinyApplied")&&x.tinymce().execCommand("mceInsertContent",!1,data.taglink),x.data("ace"))x.data("aceeditor").getSession().setValue(x.data("aceeditor").getSession().getValue()+data.taglink);else{var v=x.val();x.val(v+""+data.taglink)}$("#l_editor_"+id+" .translations").append('<a href="?cmd=langedit&action=bulktranslate&key='+data.tag+'" target="_blank">'+data.taglink+"</a>"),$("#l_editor_"+id+" .translations .taag").show()}),!1},HBInputTranslate.tinyMCEFull={theme:"advanced",plugins:"pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,formatselect,fontselect,fontsizeselect",theme_advanced_buttons2:"cut,copy,paste,pastetext,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",theme_advanced_buttons3:"tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,fullscreen",theme_advanced_buttons4:"insertlayer,moveforward,movebackward,absolute,|,styleprops|,visualchars,nonbreaking",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",skin:"o2k7",skin_variant:"silver",theme_advanced_resizing:!0,convert_urls:!1,add_form_submit_trigger:!1,setup:function(ed){ed.onSubmit.add(function(ed,ev){!ed.isHidden()&&ed.isDirty()&&ed.save()})}},HBInputTranslate.tinyMCESimple={theme:"advanced",theme_advanced_buttons1:"bold,italic,underline,separator,strikethrough,justifyleft,justifycenter,justifyright,justifyfull,bullist,numlist,undo,redo,link,unlink,code",theme_advanced_buttons2:"",skin:"o2k7",skin_variant:"silver",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",add_form_submit_trigger:!1,setup:function(ed){ed.onSubmit.add(function(ed,ev){!ed.isHidden()&&ed.isDirty()&&ed.save()})}},HBInputTranslate.editorOff=function(el,target){return target=$("#"+target),$(el).parents("ul").eq(0).find("li").removeClass("active"),$(el).parent("li").addClass("active"),target.hasClass("tinyApplied")?(target.tinymce().save(),target.tinymce().hide(),!1):!1},HBInputTranslate.editorOn=function(el,target,featureset){if(target=$("#"+target),$(el).parents("ul").eq(0).find("li").removeClass("active"),$(el).parent("li").addClass("active"),target.hasClass("tinyApplied"))target.addClass("tinyApplied").tinymce().show();else{var f=HBInputTranslate.tinyMCESimple;featureset&&"string"!=typeof featureset&&(f=featureset),target.addClass("tinyApplied").tinymce(f)}return!1},HBInputTranslate.aceOn=function(el,target){var textarea=$("#"+target),editor=$("#"+target+"-ace"),wrapp=editor.parent();if(el&&($(el).parents("ul").eq(0).find("li").removeClass("active"),$(el).parent("li").addClass("active")),1!=textarea.data("ace")){var acetor=ace.edit(target+"-ace");acetor.setTheme("ace/theme/chrome"),acetor.getSession().setMode("ace/mode/smarty"),acetor.setOptions({minLines:15,maxLines:99999,highlightActiveLine:!1}),textarea.data("ace",!0),textarea.data("aceeditor",acetor),textarea.parents("form").on("submit",function(){textarea.val(acetor.getValue())})}return 1==textarea.data("ace")&&(textarea.data("aceeditor").getSession().setValue(textarea.val()),textarea.hide(),wrapp.show()),!1},HBInputTranslate.aceOff=function(el,target){var textarea=$("#"+target),editor=$("#"+target+"-ace"),wrapp=editor.parent();return el&&($(el).parents("ul").eq(0).find("li").removeClass("active"),$(el).parent("li").addClass("active")),1==textarea.data("ace")&&(textarea.val(textarea.data("aceeditor").getValue()),textarea.show(),wrapp.hide()),!1},function($){jQuery.event.special.destroyed={remove:function(o){o.handler&&o.handler()}}}(jQuery);var Chosen={inp:function(that){if("function"!=typeof jQuery.fn.chosen)return $('<style type="text/css">@import url("templates/default/js/chosen/chosen.css")</style>').appendTo("head"),$.getScript("templates/default/js/chosen/chosen.min.js",function(){return Chosen.inp(that),!1}),!1;var xhr=!1,nextsearch=!1,selected=[that.attr("default")],lang_loading="Searching for..",_search=function(evt){var search=$(this);return selected.length||that.find(":selected").each(function(){selected.push($(this).val())}),xhr?(nextsearch=evt,!1):(that.data("chosen").results_none_found=lang_loading,void(xhr=$.post("?cmd=clients&action=search&lightweight=1",{query:evt&&evt.query||search.val()},function(data){var change=!nextsearch;xhr=!1;var ev=evt&&evt.type&&evt||$.extend({},nextsearch);if(nextsearch?(nextsearch=!1,_search.call(search[0],ev)):that.data("chosen").results_none_found="No results match",that.find(".chosen").remove(),void 0!=data.list){1==data.list.length&&selected.push(data.list[0][0]);for(var i=0;i<data.list.length;i++){var name=data.list[i][3].length?data.list[i][3]+" - "+data.list[i][1]+" "+data.list[i][2]:data.list[i][1]+" "+data.list[i][2];that.append('<option class="chosen" value="'+data.list[i][0]+'">#'+data.list[i][0]+" "+name+"</option>")}if(that.val(selected.pop()),that.trigger("liszt:updated"),ev&&ev.type){var sf=that.data("chosen").search_field;sf.val(sf.val().replace(/( )\s+/g,"$1")),that.data("chosen").results_show(),change&&that.change()}}selected=[]})))};if(that.append('<option class="loader" value="">Loading..</option>').on("liszt:ready",function(evt,ob){ob.chosen.search_container.on("keyup","input",_search),ob.chosen.search_contains=!0,ob.chosen.show_search_field_default=function(){},that.data("chosen",ob.chosen),ob.chosen.results_none_found=lang_loading,_search.call(ob.chosen.search_container,{query:selected[0]||""})}),!that.hasClass("chzn-done")){var incubator=!1,parent=!1;that.is(":visible")||(parent=that.wrap("<span></span>").parent(),incubator=$('<div style="position:abolute"></div>').appendTo("body"),that.detach().appendTo(incubator).show()),that.addClass("chzn-css-loaded").find(".loader").remove();var fakeListener=setInterval(function(){"pointer"===that.css("cursor")&&(clearInterval(fakeListener),that.removeClass("chzn-css-loaded").chosen(),incubator&&(incubator.children().detach().appendTo(parent),that.unwrap(),incubator.remove()))},50)}},recovery:function(that,i){that.bind("destroyed",function(){setTimeout(function(){var that=$("select[load]").eq(i);Chosen.recovery(that,i),Chosen.inp(that)},60)})},find:function(that,i){void 0!=that?(Chosen.recovery(that,i),
Chosen.inp(that)):$("select[load]").each(function(i){var that=$(this);"clients"==that.attr("load")&&Chosen.recovery(that,i),Chosen.inp(that)})}},AdminNotes={visible:!1,show:function(){return AdminNotes.hide(),$("#AdmNotes").show().find(".admin-note-new").show(),$("#AdmNotes .admin-note-new textarea").focus(),AdminNotes.visible=!0,!1},hide:function(){return $("#AdmNotes .admin-note-new").hide(),$("#AdmNotes .admin-note-edit:visible").each(function(){$(this).hide().prev().show()}),!1},addNew:function(){var form=$("textarea, input","#AdmNotes .admin-note-new"),data=form.serializeObject();if(data.note&&data.note.length){form.filter("textarea").val(""),$("#AdmNotes .admin-note-attach").html(""),AdminNotes.hide(),data.make="addNote",$.post($("#notesurl").attr("href"),data,AdminNotes.ajax);var date=AdminNotes.dateformat.replace("d",("0"+ts.getDate()).slice(-2)).replace("Y",ts.getFullYear()).replace("m",("0"+(ts.getMonth()+1)).slice(-2))+" "+("0"+ts.getHours()).slice(-2)+":"+("0"+ts.getMinutes()).slice(-2)+":"+("0"+ts.getSeconds()).slice(-2);$("#notesContainer").prepend('<div class="admin-note"><div class="left">'+date+" by "+AdminNotes.me+'</div><div class="admin-note-body"><br />'+data.note+"</div></div>")}return!1},edit:function(id){var value=$("#AdmNotes textarea:visible:last").val();return value&&value.length&&$.post($("#notesurl").attr("href"),{make:"editNote",note:value,noteid:id},AdminNotes.ajax),!1},init:function(){var noteslist=$("#AdmNotes");noteslist.length&&$.get($("#notesurl").attr("href")+"&make=getNotes",AdminNotes.ajax)},del:function(id){return $("#notesContainer .admin-note[rel="+id+"]").remove(),$.post($("#notesurl").attr("href"),{make:"delNote",noteid:id},AdminNotes.ajax),!1},addFile:function(){var resultlist={},place=$('<div class="result"><input type="file" data-upload="?cmd=downloads&action=upload" /></div>').appendTo(".admin-note-new .admin-note-attach").bind("fileuploadsend",function(e,data){place.children().hide();for(var i in data.files)resultlist[i]=$('<div class="upload-result"><a class="attachment" >'+data.files[i].name+'</a> <span class="ui-autocomplete-loading" style="padding: 10px;"></span></div>').appendTo(place)}).bind("fileuploadalways",function(e,data){place.children("input").remove();for(var i in data.result)if(resultlist[i]){var r=resultlist[i];r.children("span").remove(),data.result[i].error?r.append("<span>"+data.result[i].error+"</span>"):(r.append('<input name="attachments[]" value="'+data.result[i].hash+'" type="hidden"/>'),$('<a href="#" class="editbtn"></a>').append("<small>&#91;Remove&#93;</small>").appendTo(r).click(function(){return $.post(data.result[i].delete_url),r.remove(),!1}))}});return fileupload_init(),!1},ajax:function(data){data=parse_response(data),data.length?($("#AdmNotes").show(),$("#notesContainer").html(data)):AdminNotes.visible||$("#notesContainer").html("")}};